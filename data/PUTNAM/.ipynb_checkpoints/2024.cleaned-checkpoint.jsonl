{"id": "putnam-2024-a1", "question": "Determine all positive integers $n$ for which there exist positive integers $a$, $b$, and $c$ satisfying\n\\[\n2a^n + 3b^n = 4c^n.\n\\]", "solution": "The answer is $n=1$. When $n=1$, $(a,b,c) = (1,2,2)$ is a solution to the given equation. We claim that there are no solutions when $n \\geq 2$.\n\nFor $n = 2$, suppose that we have a solution to $2a^2+3b^2=4c^2$ with $a,b,c\\in\\mathbb{N}$. By dividing each of $a,b,c$ by $\\gcd(a,b,c)$, we obtain another solution; thus we can assume that $\\gcd(a,b,c) = 1$. Note that we have $a^2+c^2 \\equiv 0 \\pmod{3}$, and that only $0$ and $1$ are perfect squares mod $3$; thus we must have $a^2 \\equiv c^2 \\equiv 0 \\pmod{3}$. But then $a,c$ are both multiples of $3$; it follows from $b^2 = 12(c/3)^2-6(a/3)^2$ that $b$ is a multiple of $3$ as well, contradicting our assumption that $\\gcd(a,b,c)=1$.\n\nFor $n \\geq 3$, suppose that $2a^n+3b^n=4c^n$. As in the previous case, we can assume $\\gcd(a,b,c)=1$. Since $3b^n=4c^n-2a^n$, $b$ must be even. \nWe can then write $a^n+2^{n-1}\\cdot 3(b/2)^n = 2 c^n$, and so $a$ must be even. Then $2^{n-1}(a/2)^n+2^{n-2} \\cdot 3(b/2)^n = c^n$, and $c$ must be even as well. This contradicts our assumption that $\\gcd(a,b,c)=1$.", "category": "Number Theory", "source": "PUTNAM", "year": 2024, "content": "Determine all positive integers \\( n \\) for which there exist positive integers \\( a \\), \\( b \\), and \\( c \\) satisfying\n\\[\n2a^n + 3b^n = 4c^n.\n\\]"}
{"id": "putnam-2024-a2", "question": "For which real polynomials $p$ is there a real polynomial $q$ such that\n\\[\np(p(x)) - x = (p(x) - x)^2 q(x)\n\\]\nfor all real $x$?", "solution": "The answer is $p(x) = \\pm x+c$ for any $c \\in \\mathbb{R}$. Note that any such polynomial works: if $p(x)=x+c$ then $p(x)-x=c$, while if $p(x)=-x+c$ then $p(p(x))-x=0$.\nWe will show that in fact these are the only polynomials $p(x)$ such that $p(p(x))-x$ is divisible by $r(x)^2$, where $r(x)=p(x)-x$. \n\n<strong>First solution.</strong>\nSuppose that $p(p(x))-x$ is divisible by $r(x)^2$. Then\n\\begin{align*}\nx &\\equiv p(p(x)) \\\\\n&= p(x + r(x)) \\\\\n&\\equiv p(x) + p'(x) r(x) \\pmod{r(x)^2}.\n\\end{align*}\nIn other words, $r(x) (1 + p'(x))$ is divisible by $r(x)^2$.\nFrom this, it follows that either $r(x) = 0$ or $1+p'(x)$ is divisible by $r(x)$.\nIn the first case, we have $p(x) = x$.\nIn the second case, if $1 + p'(x) = 0$ then $p(x) = -x + c$ for some constant $c$;\notherwise, we have\n\\[\n\\deg(p) - 1 = \\deg(1 + p'(x)) \\geq \\deg(r)\n\\]\nand this is only possible if $p(x) = x + c$ for some constant $c$.\n\n<strong>Second solution.</strong>\nSuppose that $p(p(x))-x$ is divisible by $r(x)^2$. Then\n\\begin{align*}\n0 &\\equiv \\frac{d}{dx}(p(p(x)) - x) \\\\\n&= p'(x) p'(p(x)) - 1 \\\\\n&\\equiv p'(x)^2 -1 \\\\\n&= (p'(x) + 1)(p'(x) - 1) \\\\\n&= r'(x) (r'(x) + 2) \n\\pmod{r(x)}.\n\\end{align*}\nIf $\\alpha$ is a root of $r(x)$ of some multiplicity $m$, then the multiplicity of $\\alpha$ as a root of $r'(x)$ is $m-1$. Consequently, every root of $r(x)$ must be a root of $r'(x)+ 2$;\nin particular such a root cannot also be a root of $r'(x)$, so every root of $r(x)$ is simple.\nPutting this together, we deduce that $r(x)$ divides $r'(x) + 2$. If $r(x)$ is constant,\nthen $p(x) = x+c$ for some $c$. Otherwise, $\\deg(r'(x) + 2) < \\deg(r(x))$ and so $r'(x) + 2$ must be zero; then $r(x) = -2x + c$ for some $c$, whence $p(x) = -x + c$.", "category": "Algebra", "source": "PUTNAM", "year": 2024, "content": "For which real polynomials \\( p \\) is there a real polynomial \\( q \\) such that\n\\[\np(p(x)) - x = (p(x) - x)^2 q(x)\n\\]\nfor all real \\( x \\)?"}
{"id": "putnam-2024-a3", "question": "Let $S$ be the set of bijections\n\\[\nT \\colon \\{1,2,3\\} \\times \\{1,2,\\dots,2024\\} \\to \\{1,2,\\dots,6072\\}\n\\]\nsuch that $T(1,j) < T(2,j) < T(3,j)$ for all $j \\in \\{1,2,\\dots,2024\\}$ and $T(i,j) < T(i,j+1)$ for all $i \\in \\{1,2,3\\}$ and $j \\in \\{1,2,\\dots,2023\\}$. Do there exist $a$ and $c$ in $\\{1,2,3\\}$ and $b$ and $d$ in $\\{1,2,\\dots,2024\\}$ such that the fraction of elements $T$ in $S$ for which $T(a,b) < T(c,d)$ is at least $1/3$ and at most $2/3$?", "solution": "Yes, such \\( a,b,c,d \\) exist: we take\n\\[\n(a,b) = (2,1), \\qquad (c,d) = (1,2).\n\\]\nWe will represent \\( T \\) as an \\( 3 \\times n \\) array (3 rows, \\( n \\) columns) of integers in which each of \\( 1,\\dots,3n \\) occurs exactly once and the rows and columns are strictly increasing; we will specialize to \\( n=2024 \\) at the end.\n\nWe first note that \\( T(1,1) = 1 \\) and \\( 2 \\in \\{T(1,2), T(2,1)\\} \\).\nFrom this, it follows that \\( T(2,1) < T(1,2) \\) if and only if \\( T(2,1) = 2 \\).\n\nWe next recall a restricted form of the <em>hook length formula</em>\n(see the first remark for a short proof of this restricted version and the second remark for the statement of the general formula).\nConsider more generally an array consisting of (up to) three rows of lengths \\( n_1\\geq n_2 \\geq n_3 \\geq 0 \\), aligned at the left.\nLet \\( f(n_1,n_2,n_3) \\) be the number of ways to fill this array with a permutation of the numbers \\( 1,\\dots,n_1+n_2+n_3 \\) in such a way that each row increases from left to right and each column increases from top to bottom. The hook length formula then shows that \\( f(n_1,n_2,n_3) \\) equals\n\\[\n\\frac{(n_1-n_2+1)(n_1-n_3+2)(n_2-n_3+1) (n_1+n_2+n_3)!}\n{(n_1+2)! (n_2+1)! n_3!}.\n\\]\n\nWe then note that if \\( T(2,1) = 2 \\), we obtain an array with row lengths \\( n, n-1, n-1 \\) by removing 1 and 2, relabeling each remaining \\( i \\) as \\( 3n+1-i \\), and reflecting in both axes. The probability that \\( T(2,1) < T(1,2) \\) is thus\n\\begin{align*}\n\\frac{f(n,n-1,n-1)}{f(n,n,n)}\n&= \n\\frac{(2)(3)(n+1)n}{(1)(2) (3n)(3n-1)} \\\\\n&= \\frac{n+1}{3n-1} = \\frac{1}{3} + \\frac{4}{9n-3};\n\\end{align*}\nthis is always greater than \\( \\frac{1}{3} \\), and for \\( n =2024 \\) it is visibly less than \\( \\frac{2}{3} \\).\n\n<strong>Remark.</strong>\nWe prove the claimed formula for \\( f(n_1,n_2,n_3) \\) by induction on \\( n_1+n_2+n_3 \\).\nTo begin with, if \\( n_2 = n_3 = 0 \\), then the desired count is indeed \\( f(n_1, 0, 0) = 1 \\).\nNext, suppose \\( n_2 > 0, n_3 = 0 \\).\nThe entry \\( n_1 + n_2 \\) must go at the end of either the first or second row;\ncounting ways to complete the diagram from these starting points yields\n\\[\nf(n_1,n_2,0) = f(n_1-1,n_2,0) + f(n_1,n_2-1,0).\n\\]\n(This works even if \\( n_1 = n_2 \\), in which case the first row is not an option but correspondingly \\( f(n_2-1,n_2,0) = 0 \\).)\nThe induction step then follows from the identity\n\\[\n\\frac{(n_1-n_2)(n_1+1) + (n_1-n_2+2)n_2}{(n_1-n_2+1)(n_1+n_2)}  = 1.\n\\]\n(As an aside, the case \\( n_1 = n_2, n_3 = 0 \\) recovers a standard interpretation of the Catalan numbers.)\n\nFinally, suppose \\( n_3 > 0 \\). We then have\n\\begin{align*}\n&f(n_1,n_2,n_3) \\\\\n&= \nf(n_1-1,n_2,n_3) + f(n_1,n_2-1,n_3) + f(n_1,n_2,n_3-1),\n\\end{align*}\nand the induction step now reduces to the algebraic identity\n\\begin{align*}\n&\\frac{(n_1-n_2)(n_1-n_3+1)(n_1+2)}{(n_1-n_2+1)(n_1-n_3+2)(n_1+n_2+n_3)} \\\\\n&+ \\frac{(n_1-n_2+2)(n_2-n_3)(n_2+1)}{(n_1-n_2+1)(n_2-n_3+1)(n_1+n_2+n_3)} \\\\\n&+ \\frac{(n_1-n_3+3)(n_2-n_3+2)n_3}{(n_1-n_3+2)(n_2-n_3+1)(n_1+n_2+n_3)}\n= 1.\n\\end{align*}\n\n<strong>Remark.</strong>\nWe formulate the general hook length formula in standard terminology.\nLet \\( N \\) be a positive integer, and consider a semi-infinite checkerboard with top and left edges. A <em>Ferrers diagram</em> is a finite subset of the squares of the board which is closed under taking a unit step towards either edge. Given a Ferrers diagram with \\( N \\) squares, a <em>standard Young tableau</em> for this diagram is a bijection of the squares of the diagram with the integers \\( 1,\\dots,N \\) such that the numbers always increase under taking a unit step away from either edge. \n\nFor each square \\( s = (i,j) \\) in the diagram, the <em>hook length</em> \\( h_s \\) of \\( s \\) is the number of squares \\( (i',j') \\) in the diagram\nsuch that either \\( i=i', j\\leq j' \\) or \\( i\\leq i',j=j' \\) (including \\( s \\) itself). Then the number of standard Young tableaux for this diagram equals\n\\[\n\\frac{N!}{\\prod_s h_s}.\n\\]\nFor a proof along the lines of the argument given in the previous remark, see:\nKenneth Glass and Chi-Keung Ng, A simple proof of the hook length formula,\n\\textit{American Mathematical Monthly} <strong>111</strong> (2004), 700--704.", "category": "Combinatorics", "source": "PUTNAM", "year": 2024, "content": "Let $S$ be the set of bijections\n\\[\nT \\colon \\{1,2,3\\} \\times \\{1,2,\\dots,2024\\} \\to \\{1,2,\\dots,6072\\}\n\\]\nsuch that $T(1,j) < T(2,j) < T(3,j)$ for all $j \\in \\{1,2,\\dots,2024\\}$ and $T(i,j) < T(i,j+1)$ for all $i \\in \\{1,2,3\\}$ and $j \\in \\{1,2,\\dots,2023\\}$. Do there exist $a$ and $c$ in $\\{1,2,3\\}$ and $b$ and $d$ in $\\{1,2,\\dots,2024\\}$ such that the fraction of elements $T$ in $S$ for which $T(a,b) < T(c,d)$ is at least $1/3$ and at most $2/3$?"}
{"id": "putnam-2024-a4", "question": "Find all primes $p > 5$ for which there exists an integer $a$ and an integer $r$ satisfying $1 \\leq r \\leq p-1$ with the following property: the sequence $1,a,a^2,\\dots,a^{p-5}$ can be rearranged to form a sequence $b_0,b_1,b_2,\\dots,b_{p-5}$ such that $b_n-b_{n-1}-r$ is divisible by $p$ for $1 \\leq n \\leq p-5$.", "solution": "The prime $p=7$ works: choose $a=5$ and $r=3$, and note that $1,a,a^2$ can be rearranged to form $b_0=5$, $b_1=1$, $b_2=25$ satisfying the stated property.\n\nWe claim that no prime $p>7$ works. Suppose otherwise: there exist $p,a,r$ with $p>7$ and $r\\nmid p$ such that $1,a,\\ldots,a^{p-5}$ can be rearranged to form $b_0,\\ldots,b_{p-5}$ with $b_n \\equiv b_0+nr \\pmod{p}$ for all $0\\leq n\\leq p-5$. \n\nSince $r\\nmid p$, $\\{b_0,b_0+r,\\ldots,b_0+(p-5)r\\}$ represents a collection of $p-4$ distinct elements of $\\mathbb{Z}/p\\mathbb{Z}$. It follows that all of $1,a,\\ldots,a^{p-5}$ are distinct mod $p$. In particular, $p\\nmid a$; also, since $p-5 \\geq \\frac{p-1}{2}$, we conclude that $a^k \\not\\equiv 1 \\pmod{p}$ for any $1\\leq k\\leq \\frac{p-1}{2}$. It follows that $a$ is a primitive root mod $p$.\n\nSince $a$ is a primitive root, $a^{-3},a^{-2},a^{-1},a^0,\\ldots,a^{p-5}$ runs through all nonzero elements of $\\mathbb{Z}/p$ exactly once. On the other hand, $b_0-4r,b_0-3r,b_0-2r,b_0-r,b_0,\\ldots,b_0+(p-5)r$ runs through all elements of $\\mathbb{Z}/p\\mathbb{Z}$ exactly once. The given condition now implies that\n\\[\n\\{b_0-4r,b_0-3r,b_0-2r,b_0-r\\} = \\{0,c,c^2,c^3\\}\n\\]\n\nwhere $c = a^{-1}$; that is, $0,c,c^2,c^3$ can be rearranged to give an arithmetic sequence $x_1,x_2,x_3,x_4$ in $\\mathbb{Z}/p\\mathbb{Z}$.\n\nIf $0, c, c^2, c^3$ can be arranged into a four-term arithmetic progression, then by dividing the progression by $c$,\nwe see that $0,1,c,c^2$ can also be arranged into a four-term arithmetic progression. Now no two of $1,c,c^2$ can\nboth be adjacent to 0 in this arithmetic progression, or otherwise they would be negative of each other; but this is\nimpossible because the order of $c$ is greater than 4. We conclude that 0 must be either the first or the last term of the \nprogression, and by reversing the sequence if necessary, we can assume that 0 is the first term of the progression. \nNow the last three terms of this progression cannot be $1,c,c^2$ or $c^2,c,1$ in that order, as $c-1\\neq c^2-c$ because $c\\neq 1$. \nThus the only possibilities for the arithmetic progression that remain are\n\\begin{gather*}\n0,1,c^2,c; \\qquad\n0,c^2,1,c; \\\\\n0,c,1,c^2; \\qquad\n0,c,c^2,1.\n\\end{gather*}\nAs twice the second term must be the third term, and thrice the second term must be the fourth term, we immediately eliminate each of the above possibilities: the first sequence is not possible because we must have $c^2=2, c=3$, which is a valid solution only when $p=7$; for the second sequence, we must have $1=2c^2$ and $1=3c$, which is again a valid solution only when $p=7$; for the third sequence, we must have $1=2c$ and $c^2=3c$, implying $c=1/2=3$, which is possible only when $p=5$; and for the fourth sequence, we must have $c^2=2c$ and $1=3c$, implying $c=2=1/3$, which is again possible only when $p=5$.", "category": "Number Theory", "source": "PUTNAM", "year": 2024, "content": "Find all primes \\( p > 5 \\) for which there exists an integer \\( a \\) and an integer \\( r \\) satisfying \\( 1 \\leq r \\leq p-1 \\) with the following property: the sequence \\( 1,a,a^2,\\dots,a^{p-5} \\) can be rearranged to form a sequence \\( b_0,b_1,b_2,\\dots,b_{p-5} \\) such that \\( b_n-b_{n-1}-r \\) is divisible by \\( p \\) for \\( 1 \\leq n \\leq p-5 \\)."}
{"id": "putnam-2024-a5", "question": "Consider a circle $\\Omega$ with radius 9 and center at the origin $(0,0)$, and a disc $\\Delta$ with radius 1 and center at $(r,0)$, where $0 \\leq r \\leq 8$. Two points $P$ and $Q$ are chosen independently and uniformly at random on $\\Omega$. Which value(s) of $r$ minimize the probability that the chord $\\overline{PQ}$ intersects $\\Delta$?", "solution": "We will show that \\( r=0 \\) (and no other value of \\( r \\)) minimizes the stated probability. Note that \\( P \\) and \\( Q \\) coincide with probability \\( 0 \\); thus we can assume that \\( P\\neq Q \\).\n\n<strong>First solution.</strong>\nFirst restrict \\( P,Q \\) to points on \\( \\Omega \\) such that the segment \\( \\overline{PQ} \\) makes an angle of \\( \\theta \\) with the \\( y \\) axis, where \\( \\theta \\) is a fixed number with \\( -\\pi/2<\\theta\\leq\\pi/2 \\). By rotating the diagram by \\( -\\theta \\) around the origin, we move \\( \\overline{PQ} \\) to be a vertical line and move \\( \\Delta \\) to be centered at \\( (r\\cos\\theta,-r\\sin\\theta) \\). In this rotated picture, \\( P \\) and \\( Q \\) are at \\( (9\\cos\\phi,\\pm 9\\sin\\phi) \\) where \\( \\phi \\) is chosen uniformly at random in \\( (0,\\pi) \\). Now the vertical tangent lines to the boundary of \\( \\Delta \\), \\( x=r\\cos\\theta\\pm 1 \\), intersect the \\( y>0 \\) semicircle of \\( \\Omega \\) at \\( (9\\cos\\phi,9\\sin\\phi) \\) where \\( \\phi = \\cos^{-1}\\left(\\frac{r\\cos\\theta\\pm 1}{9}\\right) \\). Thus the probability that \\( \\overline{PQ} \\) intersects \\( \\Delta \\) for a specific value of \\( \\theta \\) is\n\\[\n\\frac{1}{\\pi} f(r,\\theta),\n\\]\nwhere we define \n\\[\nf(r,\\theta) = \\cos^{-1} \\left(\\frac{r\\cos\\theta-1}{9}\\right) - \\cos^{-1}\\left(\\frac{r\\cos\\theta+1}{9}\\right).\n\\]\n\nIf we now allow \\( \\theta \\) to vary (uniformly) in \\( (-\\pi/2,\\pi/2] \\), we find that the overall probability that \\( \\overline{PQ} \\) intersects \\( \\Delta \\) is\n\\[\nP(r) = \\frac{1}{\\pi^2} \\int_{-\\pi/2}^{\\pi/2} f(r,\\theta)\\,d\\theta.\n\\]\nThe function \\( P(r) \\) is differentiable with \n\\[\nP'(r) = \\frac{1}{\\pi^2} \\int_{-\\pi/2}^{\\pi/2} \\frac{\\partial f(r,\\theta)}{\\partial r}\\,d\\theta.\n\\]\nNow\n\\begin{align*}\n\\frac{\\partial f(r,\\theta)}{\\partial r} &= (\\cos t)\\left((80-2r\\cos t-r^2\\cos^2 t)^{-1/2} \\right. \\\\\n&\\qquad \\left. -(80+2r\\cos t-r^2\\cos^2 t)^{-1/2}\\right),\n\\end{align*}\nwhich, for \\( t\\in (-\\pi/2,\\pi/2) \\), is zero for \\( r=0 \\) and strictly positive for \\( r>0 \\). It follows that \\( P'(0)=0 \\) and \\( P'(r)<0 \\) for \\( r\\in (0,8] \\), whence \\( P(r) \\) is minimized when \\( r=0 \\).\n\n<strong>Second solution.</strong> (based on ideas from Elliott Liu, Bjorn Poonen, Linus Tang, and Allen Wang)\nWe interpret the first paragraph of the first solution as reducing the original problem to the following assertion: given two parallel lines at distance \\( 2 \\), both of which intersect a circle of radius \\( 9 \\), the length of either of the two congruent arcs of the circle lying between the two lines is minimized when the line halfway between the two parallel lines passes through the center of the circle.\n\nTo see this, note that the length of a minor arc of a circle is a strictly increasing function of the length of the chord connecting the two endpoints of the arc. In this case, the chord connects points on the two given parallel lines, so the distance between these points is minimized by having them be the endpoints of a segment perpendicular to the two lines; this achieves the situation described above.", "category": "Geometry", "source": "PUTNAM", "year": 2024, "content": "Consider a circle $\\Omega$ with radius 9 and center at the origin $(0,0)$, and a disc $\\Delta$ with radius 1 and center at $(r,0)$, where $0 \\leq r \\leq 8$. Two points $P$ and $Q$ are chosen independently and uniformly at random on $\\Omega$. Which value(s) of $r$ minimize the probability that the chord $\\overline{PQ}$ intersects $\\Delta$?"}
{"id": "putnam-2024-a6", "question": "Let $c_0,c_1,c_2,\\dots$ be the sequence defined so that \n\\[\n\\frac{1-3x-\\sqrt{1-14x+9x^2}}{4} = \\sum_{k=0}^\\infty c_k x^k\n\\]\nfor sufficiently small $x$. For a positive integer $n$, let $A$ be the $n$-by-$n$ matrix with $i,j$-entry $c_{i+j-1}$ for $i$ and $j$ in $\\{1,\\dots,n\\}$. Find the determinant of $A$.", "solution": "The determinant equals $10^{n(n-1)/2}$. We compute the corresponding determinant for the coefficients of the generic power series\n\\[\nf(x) := \\sum_{n=1}^\\infty c_n x^n, \\qquad c_1 = 1,\n\\]\nwith associated continued fraction\n\\[\n\\frac{a_0}{x^{-1} + b_0 + \\frac{a_1}{x^{-1} + b_1 + \\cdots}}, \\qquad a_0 = 1.\n\\]\nIf we truncate by replacing $a_{n+1} = 0$, we get a rational function which can be written as $\\frac{A_n(x^{-1})}{B_n(x^{-1})}$ where $A_n(x), B_n(x)$ are polynomials determined by the initial conditions\n\\[\nA_{-1}(x) =1, A_0(x) = 0, \\quad B_{-1}(x) = 0, B_0(x) = 1\n\\]\nand the recurrences\n\\begin{align*}\nA_{n+1}(x) &= (x + b_{n})A_n(x) + a_{n} A_{n-1}(x) \\qquad (n > 0) \\\\\nB_{n+1}(x) &= (x + b_{n})B_n(x) + a_{n} B_{n-1}(x) \\qquad (n > 0).\n\\end{align*}\nSince each additional truncation accounts for two more coefficients of the power series, we have\n\\[\n\\frac{A_n(x^{-1})}{B_n(x^{-1})} = f(x) + O(x^{2n+1}),\n\\]\nor equivalently (since $B_n(x)$ is monic of degree $n$)\n\\begin{equation} \\label{eq:convergent}\nf(x) B_n(x^{-1}) - A_n(x^{-1}) = O(x^{n+1}).\n\\end{equation}\n\nWe now reinterpret in the language of <em>orthogonal polynomials</em>. For a polynomial $P(x) = \\sum_i P_i x^i$, define\n\\[\n\\int_\\mu P(x) = \\sum_i P_i c_{i+1};\n\\]\nthen the vanishing of the coefficient of $x^{i+1}$\nin \\eqref{eq:convergent} (with $n := i$) implies that\n\\[\n\\int_\\mu x^i B_j(x) = 0 \\qquad (j < i).\n\\]\nBy expanding $0 = \\int_\\mu x^{i-1} B_{i+1}(x)$ using the recurrence, we deduce that $\\int_\\mu x^i B_i(x) + a_i \\int_\\mu x^{i-1} B_{i-1}(x) = 0$, and so\n\\[\n\\int_\\mu x^i B_i(x) = (-1)^i a_1 \\cdots a_i.\n\\]\nWe deduce that\n\\begin{equation} \\label{eq:orthogonality}\n\\int_\\mu B_i(x) B_j(x) = \\begin{cases} 0 & i \\neq j \\\\\n(-1)^i a_1 \\cdots a_i & i = j.\n\\end{cases}\n\\end{equation}\nIn other words, for $U$ the $n \\times n$ matrix such that\n$U_{ij}$ is the coefficient of $x^j$ in $B_i(x)$,\nthe matrix $UAU^t$ is a diagonal matrix $D$ with diagonal entries\n$D_{i,i} = (-1)^{i-1} a_1 \\cdots a_{i-1}$ for $i=1,\\dots,n$. Since $U$ is a unipotent matrix, its determinant is 1; we conclude that\n\\[\n\\det(A) = \\det(D) = (-1)^{n(n-1)/2} a_1^{n-1} \\cdots a_{n-1}.\n\\]\n\nWe now return to the sequence $\\{c_n\\}$ given in the problem statement, for which\n\\[\nf(x) = \\frac{1 - 3x - \\sqrt{1 - 14x +9x^{2}}}{4}.\n\\]\nFor \n\\[\ng(x) := \\frac{1-7x-\\sqrt{1-14x+9x^2}}{2x},\n\\]\nwe have\n\\[\nf(x) = \\frac{1}{x^{-1} - 5 - g(x)}, \\quad\ng(x) = \\frac{10}{x^{-1} - 7 - g(x)}.\n\\]\nThis means that the continued fraction is eventually periodic; in particular, $a_1 = a_2 = \\cdots = -10$. Plugging into the general formula for $\\det(A)$ yields the desired result. This yields the desired result.\n\n<strong>Reinterpretation.</strong> (suggested by Bjorn Poonen) Given a formal Laurent series $\\alpha = \\sum_i a_i x^i$, define the matrices\n$H_n(\\alpha) = (a_{i+j-1})_{i,j=1}^n$ and the determinants $h_n(\\alpha) = \\det H_n(\\alpha)$. One can then recover the evaluation of the determinants from the following lemma.\n\n<div class=\"lemma*\">\nSuppose $\\alpha = \\sum_{i=1}^\\infty a_i x^i$ is a formal power series with $a_i = 1$. Define the power series $\\beta$ by $\\alpha^{-1} = x^{-1} - \\beta$. Then for all $n \\geq 1$,\n$h_n(\\alpha) = h_{n-1}(\\beta)$.\n</div>\n<div class=\"proof\">\nFor $m \\geq 2$, by equating the coefficients of $x^m$ in the equality $x^{-1} \\alpha = \\alpha \\beta + 1$, we obtain\n\\[\na_{m+1} = \\sum_{r=1}^m a_r b_{m-r}.\n\\]\nWe now perform some row and column reduction on $H_n(\\alpha)$ without changing its determinant. Starting with $H_n(\\alpha)$, for $i = n,n-1,\\dots,2$ in turn, for $k=1,\\dots,i-1$ subtract $b_{i-1-k}$ times row $k$ from row $i$. In light of the recurrence relation, the resulting matrix $M = (m_{ij})$ has the property that for $i \\geq 2$,\n\\begin{align*}\nm_{ij} &= a_{i+j-1} - \\sum_{k=1}^{i-1} a_{j+k-1} b_{i-1-k} \\\\\n&= \\sum_{r=1}^{j-1}  a_r b_{i+j-2-r}.\n\\end{align*}\nIn particular, $m_{i1} = 0$ for $i \\geq 2$. Starting from $M$, for $j=2,\\dots,n-1$ in turn, for $k=j+1,\\dots,n$ subtract $a_{k-j+1}$ times column $j$ from column $i$. The resulting matrix has first column $(1, 0,\\dots,0)$ and removing its first row and column leaves $H_{n-1}(\\beta)$, yielding the claimed equality.\n</div>\n\n<strong>Remark.</strong> A matrix $A$ whose $i,j$-entry depends only on $i+j$ is called a <em>Hankel matrix</em>. The above computation of the determinant of a Hankel matrix in terms of continued fractions is adapted from H.S. Wall, \\textit{Analytic Theory of Continued Fractions}, Theorems 50.1 and 51.1.\n\nThe same analysis shows that if we define the sequence $\\{c_n\\}_{n=1}$ by $c_1 = 1$ and\n\\[\nc_n = a c_{n-1} + b \\sum_{i=1}^{n-1} c_i c_{n-i} \\qquad (n > 1),\n\\]\nthen  $a_n = -ab-b^2$, $b_n = -a-2b$ for all $n>0$ and so\n\\[\n\\det(A) = (ab+b^2)^{n(n-1)/2};\n\\]\nthe problem statement is the case $a=3, b=2$. The case $a=0, b=1$ yields the sequence of Catalan numbers; the case $a=1, b=1$ yields the Schr\\\"oder numbers (OEIS sequence A006318).\n\nThere are a number of additional cases of Hankel determinants of interest in combinatorics. For a survey, see: A. Junod, Hankel determinants and orthogonal polynomials, \\textit{Expositiones Mathematicae} <strong>21</strong> (2003), 63--74.", "category": "Algebra", "source": "PUTNAM", "year": 2024, "content": "Let $c_0,c_1,c_2,\\dots$ be the sequence defined so that \n\\[\n\\frac{1-3x-\\sqrt{1-14x+9x^2}}{4} = \\sum_{k=0}^\\infty c_k x^k\n\\]\nfor sufficiently small $x$. For a positive integer $n$, let $A$ be the $n$-by-$n$ matrix with $i,j$-entry $c_{i+j-1}$ for $i$ and $j$ in $\\{1,\\dots,n\\}$. Find the determinant of $A$."}
{"id": "putnam-2024-b1", "question": "Let $n$ and $k$ be positive integers. The square in the $i$th row and $j$th column of an $n$-by-$n$ grid contains the number $i+j-k$. For which $n$ and $k$ is it possible to select $n$ squares from the grid, no two in the same row or column, such that the numbers contained in the selected squares are exactly $1,2,\\dots,n$?", "solution": "This is possible if and only if $n$ is odd and $k = (n+1)/2$.\n\nWe first check that these conditions are necessary. If the pairs $(a_1,b_1),\\dots,(a_n,b_n)$ index squares of the grid with no two in the same row or column, then each of the two sequences $a_1,\\dots,a_n$ and $b_1,\\dots,b_n$ is a permutation of $\\{1,\\dots,n\\}$, and so in particular has sum $1 + \\cdots +n = \\frac{n(n+1)}{2}$. In particular, if the selected numbers are $1,2,\\dots,n$ in some order, then\n\\[\n\\begin{align*}\n\\frac{n(n+1)}{2} &= \\sum_{i=1}^n (a_i+b_i-k) \\\\\n&= \\sum_{i=1}^n a_i + \\sum_{i=1}^n b_i - \\sum_{i=1}^n k \\\\\n&= \\frac{n(n+1)}{2} + \\frac{n(n+1)}{2} - nk\n\\end{align*}\n\\]\nwhich simplifies to $k = (n+1)/2$.\n\nWe next check that these conditions are sufficient. For this, it suffices to observe that the sequence\n\\[\n\\begin{gather*}\n\\left(1, \\frac{n+1}{2}\\right), \\left(2, \\frac{n+3}{2}\\right), \\dots, \\left(\\frac{n+1}{2}, n\\right), \\\\\n\\left(\\frac{n+3}{2}, 1\\right), \\dots, \\left(n, \\frac{n-1}{2}\\right)\n\\end{gather*}\n\\]\nof grid entries equals\n\\[\n1, 3, \\dots, n, 2, \\dots, n-1.\n\\]\nWe illustrate this for the case $n=5, k=3$ below; the selected entries are parenthesized.\n\\[\n\\begin{pmatrix}\n-1 & 0 & (1) & 2 & 3 \\\\\n0 & 1 & 2 & (3) & 4 \\\\\n1 & 2 & 3 & 4 & (5) \\\\\n(2) & 3 & 4 & 5 & 6 \\\\\n3 & (4) & 5 & 6 & 7\n\\end{pmatrix}\n\\]", "category": "Combinatorics", "source": "PUTNAM", "year": 2024, "content": "Let \\( n \\) and \\( k \\) be positive integers. The square in the \\( i \\)th row and \\( j \\)th column of an \\( n \\)-by-\\( n \\) grid contains the number \\( i+j-k \\). For which \\( n \\) and \\( k \\) is it possible to select \\( n \\) squares from the grid, no two in the same row or column, such that the numbers contained in the selected squares are exactly \\( 1,2,\\dots,n \\)?"}
{"id": "putnam-2024-b2", "question": "Two convex quadrilaterals are called \\emph{partners} if they have three vertices in common and they can be labeled $ABCD$ and $ABCE$ so that $E$ is the reflection of $D$ across the perpendicular bisector of the diagonal $\\overline{AC}$. Is there an infinite sequence of convex quadrilaterals such that each quadrilateral is a partner of its successor and no two elements of the sequence are congruent?\n[A diagram has been omitted.]", "solution": "No, there is no such sequence. In other words, any sequence of convex quadrilaterals with the property that any two consecutive terms are partners must be finite.\n\n<strong>First solution.</strong>\n\n<div class=\"lemma\">\nGiven five positive real numbers $a,b,c,d,K$, there are only finitely many convex quadrilaterals with side lengths $a,b,c,d$ in that order and area $K$. \n</div>\n<div class=\"proof\">\nLet $PQRS$ be a convex quadrilateral with \n\\[\n\\overline{PQ} = a, \\overline{QR} = b, \\overline{RS} = c, \\overline{SP} = d.\n\\]\nThen the congruence class of $PQRS$ is uniquely determined by the length of the diagonal $f := \\overline{PR}$.\nMoreover, as $f$ increases, the angles $\\angle RPQ$ and $\\angle RPS$ are both strictly decreasing, so $\\angle SPQ$ is decreasing; by the same logic, $\\angle QRS$ is decreasing. \n\nWe next recall <em>Bretschneider's formula</em>: for $s = (a+b+c+d)/2$,\n\\[\nK^2 = (s-a)(s-b)(s-c)(s-d) - abcd \\cos^2 \\frac{\\angle SPQ + \\angle QRS}{2}.\n\\]\nConsequently, fixing $K$ also fixes $\\cos^2 \\frac{\\angle SPQ + \\angle QRS}{2}$,\nand thus limits $\\angle SPQ + \\angle QRS$ to one of two values. By the previous paragraph, this leaves at most two possible congruence classes for the triangle.\n</div>\n\nReturning to our original sequence, note that any two consecutive quadrilaterals in the sequence have the same area and the same unordered list of side lengths. The latter can occur as an ordered list in at most six different ways (up to cyclic shift); for each of these, we can have only finitely many distinct congruence classes of quadrilaterals in our sequence with that area and ordered list of side lengths. We deduce that our sequence must be finite.\n\n<strong>Remark.</strong>\nVarious proofs of the lemma are possible; for example, here is one using Cartesian coordinates. We \nfirst specify \n\\[\nP = (0,0), Q = (a, 0).\n\\]\nFor two additional points $R = (x,y), S = (z,w)$, the conditions $\\overline{QR} = b$, $\\overline{SP} = d$ restrict $R$ and $S$ to the circles\n\\[\n(x-a)^2 + y^2 = b^2, \\quad\nz^2+w^2 = d^2\n\\]\nrespectively. Since we want a convex quadrilateral, we may assume without loss of generality that $y,w > 0$.\nThe area of the quadrilateral is $\\frac{1}{2} a(y+w)$, which we also want to fix; we may thus regard $w$ as a function of $y$ (possibly restricting $y$ to a range for which $w>0$). After splitting the semicircles on which $R$ and $S$ lie into two arcs each, we may also regard $x$ and $w$ as functions of $y$. It now suffices to observe that $\\overline{RS}^2 = (z-x)^2 + (w-y)^2$\nis a nonconstant algebraic function of $y$, so it takes any given value only finitely many times.\n\n<strong>Second solution.</strong>\nLet $ABCD$ be the first quadrilateral in the sequence.\nSince the quadrilateral is convex, the diagonals $\\overline{AC}$ and $\\overline{BD}$ intersect. In particular they are not parallel, so their perpendicular bisectors are not parallel either; let $O$ be the intersection\nof the bisectors.\n\nWe claim that the point $O$ remains fixed throughout the sequence, as do the distances $OA, OB, OC, OD$. To see this, we check this for two partners as described in the problem statement: the diagonal $\\overline{BD}$ gets reflected across the perpendicular bisector of $\\overline{AC}$, so its perpendicular bisector also gets reflected; the point $O$ is the unique point on the perpendicular bisector of $\\overline{BD}$ fixed by the reflection. In particular, the segments $\\overline{OD}$ and $\\overline{OE}$ are mirror images across the perpendicular bisector of $\\overline{AC}$, so their lengths coincide.\n\nAs noted in the first solution, the unordered list of side lengths of the quadrilateral also remains invariant throughout the sequence. Consequently, the unordered list of side lengths of each of the triangles $\\triangle OAB, \\triangle OBC, \\triangle OCD, \\triangle ODA$ is limited to a finite set;\neach such list uniquely determines the unoriented congruence class of the corresponding triangle,\nand limits the oriented congruence class to two possibilities. Given the oriented congruence classes of the four triangles we can reconstruct the quadrilateral $ABCD$ up to oriented congruence (even up to rotation around $O$); this proves that the sequence must be finite.", "category": "Geometry", "source": "PUTNAM", "year": 2024, "content": "Two convex quadrilaterals are called <em>partners</em> if they have three vertices in common and they can be labeled $ABCD$ and $ABCE$ so that $E$ is the reflection of $D$ across the perpendicular bisector of the diagonal $\\overline{AC}$. Is there an infinite sequence of convex quadrilaterals such that each quadrilateral is a partner of its successor and no two elements of the sequence are congruent?  \n[A diagram has been omitted.]"}
{"id": "putnam-2024-b3", "question": "Let $r_n$ be the $n$th smallest positive solution to $\\tan x = x$, where the argument of tangent is in radians. Prove that\n\\[\n0 < r_{n+1} - r_n - \\pi < \\frac{1}{(n^2+n)\\pi}\n\\]\nfor $n \\geq 1$.", "solution": "<strong>First solution.</strong> (by Bjorn Poonen)  \nLet $\\tan^{-1} \\colon \\mathbb{R} \\to (-\\frac{\\pi}{2}, \\frac{\\pi}{2})$ be the principal branch of the arctangent function, and set $t(x) := x - \\tan^{-1}(x)$. Then $t(0) = 0$ and  \n\\[\n\\frac{dt}{dx} = 1 - \\frac{1}{1+x^2} = \\frac{x^2}{1+x^2} > 0 \\qquad (x \\neq 0),\n\\]  \nso $t(x)$ is strictly increasing.  \nWe have $\\tan x = x$ if and only if $x = \\tan^{-1} x + n\\pi$ for some $n \\in \\mathbb{Z}$; from the previous analysis it follows that $r_n$ is the unique solution of $t(x) = n \\pi$.  \n\nLet $x(t)$ be the inverse function of $t(x)$, so that $r_n = x(n\\pi)$. We compute that  \n\\begin{align*}  \n\\frac{dx}{dt} - 1 &= \\frac{1}{dt/dx} - 1 = \\frac{1}{x^2} \\\\  \n\\frac{dx}{dt} - 1 - \\frac{1}{t^2} &= \\frac{1}{x^2} - \\frac{1}{t^2}.  \n\\end{align*}  \nFrom this we deduce that $x(t) - t$ is strictly increasing for $t > 0$ (as then $x(t) > 0$) and $x(t) - t + \\frac{1}{t}$ is strictly decreasing for $t > 0$ (as then $\\tan^{-1}(x(t)) > 0$ and so $t < x(t)$). Evaluating at $t = n\\pi$ and $t = (n+1)\\pi$, we obtain  \n\\begin{align*}  \nr_n - n\\pi &< r_{n+1} - (n+1) \\pi \\\\  \nr_n - n\\pi + \\frac{1}{n\\pi} &> r_{n+1} - (n+1)\\pi + \\frac{1}{(n+1)\\pi},  \n\\end{align*}  \nwhich are the desired inequalities.  \n\n<strong>Second solution.</strong>  \nDefine the function  \n\\[\nf(x) := \\tan x - x.  \n\\]  \nWe then have $f'(x) = \\tan^2 x$.  \nBy induction on $k$, $f^{(k)}(x)$ is a polynomial of degree $k+1$ in $\\tan x$ with leading coefficient $k!$ and all coefficients nonnegative. In particular, on each of the intervals  \n\\[\nI_n := \\left(n \\pi, n \\pi + \\frac{\\pi}{2} \\right)  \\qquad (n=0,1,\\dots),  \n\\]  \n$\\tan x$ is positive and so $f^{(k)}(x)$ is positive for each $k \\geq 1$; replacing $k$ with $k+1$, we deduce that each $f^{(k)}(x)$ is strictly increasing on $I_n$ for $k \\geq 0$.  \n\nWe now analyze $f$ more closely on $I_n$. As $x \\to n\\pi^+$ for $n>0$, $f(x)$ tends to $f(n\\pi) = -n\\pi < 0$; by contrast, as $x \\to 0^+$, $f(x)$ tends to 0 via positive values. In either case, as $x \\to (n \\pi + \\frac{\\pi}{2})^-$, $f(x) \\to \\infty$. Since $f(x)$ is strictly increasing on $I_n$, we deduce using the intermediate value theorem that:  \n<ul>  ", "category": "Geometry", "source": "PUTNAM", "year": 2024, "content": "Let $r_n$ be the $n$th smallest positive solution to $\\tan x = x$, where the argument of tangent is in radians. Prove that\n\\[\n0 < r_{n+1} - r_n - \\pi < \\frac{1}{(n^2+n)\\pi}\n\\]\nfor $n \\geq 1$."}
{"id": "putnam-2024-b4", "question": "Let $n$ be a positive integer. Set $a_{n,0} = 1$. For $k \\geq 0$, choose an integer $m_{n,k}$ uniformly at random from the set $\\{1,\\dots,n\\}$, and let\n\\[\na_{n,k+1} = \\begin{cases} a_{n,k} + 1, & \\mbox{if $m_{n,k} > a_{n,k};$} \\\\\na_{n,k}, & \\mbox{if $m_{n,k} = a_{n,k}$;} \\\\\na_{n,k}-1, & \\mbox{if $m_{n,k} < a_{n,k}$.}\n\\end{cases}\n\\]\nLet $E(n)$ be the expected value of $a_{n,n}$. Determine $\\lim_{n\\to \\infty} E(n)/n$.", "solution": "The limit equals $\\frac{1-e^{-2}}{2}$.\n\n<strong>First solution.</strong>\nWe first reformulate the problem as a Markov chain.\nLet $v_k$ be the column vector of length $n$ whose $i$-th entry is the probability that $a_{n,k} = i$, so that $v_0$ is the vector $(1,0,\\dots,0)$.\nThen for all $k \\geq 0$, $v_{k+1} = A v_k$ where $A$ is the $n \\times n$\nmatrix defined by\n\\[\nA_{ij} = \\begin{cases}\n\\frac{1}{n} & \\mbox{if $i = j$} \\\\\n\\frac{j-1}{n} & \\mbox{if $i = j-1$} \\\\\n\\frac{n-j}{n} & \\mbox{if $i = j+1$} \\\\\n0 & \\mbox{otherwise.}\n\\end{cases}\n\\]\nLet $w$ be the row vector $(1, \\dots, n)$; then the expected value of $a_{n,k}$ is the sole entry of the $1 \\times 1$ matrix $w v_k = w A^k v_0$. In particular, $E(n) = w A^n v_0$.\n\nWe compute some left eigenvectors of $A$. First,\n\\[\nw_0 := (1,\\dots,1)\n\\]\nsatisfies $Aw_0 = w_0$. Second,\n\\begin{align*}\nw_1 &:= (n-1, n-3, \\dots, 3-n, 1-n) \\\\\n&= (n-2j+1\\colon j=1,\\dots,n)\n\\end{align*}\nsatisfies $Aw_1 = \\frac{n-2}{n} w_1$: the $j$-th entry of $Aw_i$ equals\n\\begin{align*}\n&\\frac{j-1}{n} (n+3-2j) + \\frac{1}{n} (n+1-2j) + \\frac{n-j}{n} (n-1-2j) \\\\\n&\\quad= \\frac{n-2}{n} (n-2j+1).\n\\end{align*}\nBy the same token, we obtain\n\\[\nw = \\frac{n+1}{2} w_0 - \\frac{1}{2} w_1;\n\\]\nwe then have\n\\begin{align*}\n\\frac{E(n)}{n} &= \\frac{n+1}{2n} w_0A^n v_0 - \\frac{1}{2n} w_1A^n v_0 \\\\\n&= \\frac{n+1}{2n} w_0 v_0 - \\frac{1}{2n} \\left( 1 - \\frac{2}{n} \\right)^n w_1 v_0  \\\\\n&= \\frac{n+1}{2n} - \\frac{n-1}{2n} \\left( 1 - \\frac{2}{n} \\right)^n.\n\\end{align*}\nIn the limit, we obtain\n\\begin{align*}\n\\lim_{n \\to \\infty} \\frac{E(n)}{n} &= \\frac{1}{2} - \\frac{1}{2} \\lim_{n \\to \\infty} \\left( 1 - \\frac{2}{n} \\right)^n \\\\\n&= \\frac{1}{2} - \\frac{1}{2} e^{-2}.\n\\end{align*}\n\n<strong>Remark.</strong>\nWith a bit more work, one can show that $A$ has eigenvalues\n$\\frac{n-2j}{n}$ for $j=0,\\dots,n-1$, and find the corresponding left and right eigenvectors.\nIn particular, it is also possible (but much more complicated) to express $v_0$ as a linear combination of right eigenvectors and use this to calculate $A^n v_0$.\n\n<strong>Second solution.</strong> \nWe reinterpret the Markov chain in combinatorial terms.\nConsider an apparatus consisting of one red light bulb, which is initially lit,\nplus $n-1$ white light bulbs, which are initially unlit. \nWe then repeatedly perform the following operation. \nPick one light bulb uniformly at random. If it is the red bulb, do nothing;\notherwise, switch the bulb from lit to unlit or vice versa.\nAfter $k$ operations of this form, the random variable $a_{n,k}$ is equal to the number of lit bulbs (including the red bulb).\n\nWe may then compute the expected value of $a_{n,n}$ by summing over bulbs.\nThe red bulb contributes 1 no matter what. Each other bulb contributes $1$ if it is switched an odd number of times and 0 if it is switched an even number of times,\nor equivalently $\\frac{1}{2}(1-(-1)^j)$ where $j$ is the number of times this bulb is switched.\nHence each bulb other than the red bulb contributes\n\\begin{align*} \n&n^{-n} \\sum_{i=0}^n \\frac{1}{2}(1-(-1)^i) \\binom{n}{i} (n-1)^{n-i} \\\\\n&= \\frac{n^{-n}}{2} \\left( \\sum_{i=0}^n \\binom{n}{i} (n-1)^{n-i} \n- \\sum_{i=0}^n (-1)^i \\binom{n}{i} (n-1)^{n-i} \\right) \\\\\n&= \\frac{n^{-n}}{2} \\left( (1+(n-1))^n - (-1+(n-1))^n \\right) \\\\\n&= \\frac{n^{-n}}{2} (n^2 - (n-2)^n) \\\\\n&= \\frac{1}{2} - \\frac{1}{2} \\left( 1 - \\frac{2}{n} \\right)^n.\n\\end{align*}\nThis tends to $\\frac{1 - e^{-2}}{2}$ as $n \\to \\infty$. Since $E(n)$ equals $n-1$ times this contribution plus 1, $\\frac{E(n)}{n}$ tends to the same limit.\n\n<strong>Third solution.</strong>\nWe compare the effect of taking \n$a_{n,0} = j$ versus $a_{n,0} = j+1$ for some $j \\in \\{1,\\dots,n-1\\}$.\nIf $m_{n,0} \\in \\{j,j+1\\}$ then the values of $a_{n,1}$ coincide, as then do the subsequent values\nof $a_{n,k}$; this occurs with probability $\\frac{2}{n}$. Otherwise, the values of $a_{n,1}$ differ by 1 and the situation repeats.\n\nIterating, we see that the two sequences remain 1 apart (in the same direction) with probability $\\left( \\frac{n-2}{n} \\right)^n$ and converge otherwise. Consequently, changing the start value from $j$ to $j+1$ increases the expected value of $a_{n,n}$ by $\\left( \\frac{n-2}{n} \\right)^n$. \n\nNow let $c$ be the expected value of $a_{n,n}$ in the original setting where $a_{n,0} = 1$.\nBy symmetry, if we started with $a_{n,0} = n$ the expected value would change from $c$ to $n+1-c$;\non the other hand, by the previous paragraph it would increase by \n$(n-1)\\left( \\frac{n-2}{n} \\right)^n$. We deduce that\n\\[\nc = \\frac{1}{2} \\left( n+1 - (n-1) \\left( \\frac{n-2}{n} \\right)^n \\right)\n\\]\nand as above this yields the claimed limit.", "category": "Combinatorics", "source": "PUTNAM", "year": 2024, "content": "Let $n$ be a positive integer. Set $a_{n,0} = 1$. For $k \\geq 0$, choose an integer $m_{n,k}$ uniformly at random from the set $\\{1,\\dots,n\\}$, and let\n\\[\na_{n,k+1} = \\begin{cases} a_{n,k} + 1, & \\mbox{if $m_{n,k} > a_{n,k};$} \\\\\na_{n,k}, & \\mbox{if $m_{n,k} = a_{n,k}$;} \\\\\na_{n,k}-1, & \\mbox{if $m_{n,k} < a_{n,k}$.}\n\\end{cases}\n\\]\nLet $E(n)$ be the expected value of $a_{n,n}$. Determine $\\lim_{n\\to \\infty} E(n)/n$."}
{"id": "putnam-2024-b5", "question": "Let $k$ and $m$ be positive integers. For a positive integer $n$, let $f(n)$ be the number of integer sequences $x_1,\\dots,x_k,y_1,\\dots,y_m,z$ satisfying $1 \\leq x_1 \\leq \\cdots \\leq x_k \\leq z \\leq n$ and $1 \\leq y_1 \\leq \\cdots \\leq y_m \\leq z \\leq n$. Show that $f(n)$ can be expressed as a polynomial in $n$ with nonnegative coefficients.", "solution": "For convenience, we extend the problem to allow nonnegative values for $k$ and $m$.\n\n<strong>First solution.</strong>\nLet $R(n,k)$ denote the number of subsets of $\\{1,\\ldots,n\\}$ of size $k$ where repetitions are allowed. The ``sticks and stones'' argument shows that \n\\[\nR(n,k) = \\binom{n+k-1}{k}:\n\\]\nthere is a bijection of these subsets with linear arrangements of $k$ (unlabeled) sticks and $z-1$ (unlabeled) stones, where we recover the subset by counting the number of stones to the left of each stick.\n\nLet $f_{k,m}(n) := \\sum_{z=1}^n R(z,k)R(z,m)$. It is known that for any positive integer $k$, the sum of the $k$-th powers of all positive integers less than or equal to $n$ is a polynomial in $n$ (given explicitly in terms of Bernoulli numbers via Faulhaber's formula); hence $f_{k,m}(n)$ is a polynomial in $n$. We wish to show that this polynomial has nonnegative coefficients.\n\nUsing the recursion for binomial coefficients, we obtain\n\\begin{align*}\nR(n,k)R(n,m) &= f_{k,m}(n) - f_{k,m}(n-1) \\\\\n&= \\sum_{z=1}^n \\left( R(z,k)R(z,m) - R(z-1,k)R(z-1,m)\\right)\\\\\n&= \\sum_{z=1}^n \\left( R(z,k)R(z,m) - R(z-1,k)R(z,m) \\right.\\\\\n&\\quad \\left. + R(z-1,k)R(z,m) - R(z-1,k)R(z-1,m) \\right) \\\\\n&= \\sum_{z=1}^n \\left( R(z,k-1)R(z,m) + R(z-1,k)R(z,m-1) \\right) \\\\\n&= \\sum_{z=1}^n \\left( R(z,k-1)R(z,m) \\right. \\\\\n&\\quad \\left. + (R(z,k)-R(z,k-1))R(z,m-1) \\right)\\\\\n&= f_{k-1,m}(n) + f_{k,m-1}(n) - f_{k-1,m-1}(n).\n\\end{align*}\nIt follows from the latter equation (replacing the index $m$ by $m+1$) that\n\\begin{equation} \\label{eq:summation recurrence}\nf_{k,m}(n) = R(n,k)R(n,m+1) + f_{k-1,m}(n) - f_{k-1,m+1}(n);\n\\end{equation}\nthis can also be recovered by applying Abel summation (summation by parts) to\n$\\sum_{z=1}^n R(z,k) R(z,m)$.\n\nUsing \\eqref{eq:summation recurrence}, we can evaluate $f_{k,m}$ by induction on $k$: for the first few values we obtain\n\\begin{align*}\nf_{0,m}(n) &= R(n,m+1) \\\\\nf_{1,m}(n) &= R(n,1)R(n,m+1) + R(n,m+1) - R(n,m+2) \\\\\n           & = R(n,m+1)\\frac{(m+1)n+1}{m+2} \\\\\n           & = R(n,m+1) \\frac{R(m+1,1)R(n,1) + 1}{m+2}\n\\end{align*}\nand similarly\n\\begin{align*}\nf_{2,m}(n) &= R(n,m+1) \\frac{R(m+1,2)R(n,2) + R(m+1,1)R(n,1) + R(m+1,0)R(n,0)}{R(m+2,2)}.\n\\end{align*}\nThis leads us to conjecture that\n\\begin{equation} \\label{eq:summation formula}\nf_{k,m}(n) = \\frac{R(n,m+1)}{R(m+2,k)} \\sum_{i=0}^k R(m+1,i)R(n,i),\n\\end{equation}\nwhich we prove by induction on $k$. The base case $k=0$ is evident; given \\eqref{eq:summation formula} with $k$ replaced by $k-1$, we apply \\eqref{eq:summation recurrence} to obtain\n\\begin{align*}\n&f_{k,m}(n) \\\\\n&= R(n,k) R(n,m+1) + \\frac{R(n,m+1)}{R(m+2,k-1)} \\sum_{i=0}^{k-1} R(m+1,i)R(n,i)\\\\\n&\\quad - \\frac{R(n,m+2)}{R(m+3,k-1)} \\sum_{i=0}^{k-1} R(m+2,i)R(n,i) \\\\\n&= \\frac{R(n,m+1)}{R(m+2,k)} \\sum_{i=0}^k R(m+1,i)R(n,i)\n\\end{align*}\nyielding \\eqref{eq:summation formula} as written.\n\nSince $R(n,i) = \\frac{n(n+1)(n+2)\\cdots (n+i-1)}{i!}$ clearly has positive coefficients for all $i$, the explicit formula \\eqref{eq:summation formula} implies that $f_{k,m}(n)$ also has positive coefficients for all $k$ and $m$.\n\n<strong>Second solution.</strong>\n(by an anonymous Putnam participant)\nAs in the first solution, we deduce that $f_{k,m}(n)$ is a polynomial in $n$ of degree $k+m+1$ satisfying $f_{k,m}(0) = 0$ and $f_{k,m}(n) - f_{k,m}(n-1) = R(n,k)R(n,m)$. Since $f_{k,m}(n) > 0$ for $n \\gg 0$, this polynomial has positive leading coefficient. To prove that it has nonnegative coefficients, it will suffice to prove the stronger assertion that the roots of $f_{k,m}(x)$ are all real and nonpositive, as then this will imply that $f_{k,m}(x) = c \\prod_{j=0}^{k+m} (x + r_j)$ for some $r_j \\geq 0$.\n\nSince $R(n,m) = 0$ for $m=0,-1,\\ldots,-m+1$, we deduce that $f_{k,m}(n) = 0$ for \n$n=0,-1,\\ldots,-m$. Consequently, $f_{k,m}(x)$ can be written as $x(x+1)\\cdots(x+m) Q(x)$ for some polynomial $Q(x)$ of degree $k$, and it will suffice to check that $Q(x)$ has $k$ distinct negative real roots.\n\nFrom the equality $f_{k,m}(n) - f_{k,m}(n-1) = R(n,k)R(n,m)$, if we substitute in for $Q(x)$ and divide out common factors, we obtain\n\\[\n(x+m) Q(x) - (x-1) Q(x-1) = \\frac{1}{m!} R(x,k).\n\\]\nSubstituting $x=0,-1,\\ldots,-k+1$ in turn, we obtain\n\\[\nQ(-j) = - \\frac{j+1}{m-j} Q(-j-1) \\quad (j=0,\\ldots,k-1).\n\\]\nIn particular, if any of $Q(0),\\ldots,Q(-k)$ were zero, then all of them would be zero and \n$Q$ would have too many roots for its degree. Consequently, $Q(0),\\ldots,Q(-k)$ are all nonzero and alternating in sign. By the intermediate value theorem, $Q$ has a root $r_j$ in the interval $(-j-1,-j)$ for $j=0,\\ldots,k-1$; this completes the proof.", "category": "Combinatorics", "source": "PUTNAM", "year": 2024, "content": "Let \\( k \\) and \\( m \\) be positive integers. For a positive integer \\( n \\), let \\( f(n) \\) be the number of integer sequences \\( x_1,\\dots,x_k,y_1,\\dots,y_m,z \\) satisfying \\( 1 \\leq x_1 \\leq \\cdots \\leq x_k \\leq z \\leq n \\) and \\( 1 \\leq y_1 \\leq \\cdots \\leq y_m \\leq z \\leq n \\). Show that \\( f(n) \\) can be expressed as a polynomial in \\( n \\) with nonnegative coefficients."}
{"id": "putnam-2024-b6", "question": "For a real number $a$, let $F_a(x) = \\sum_{n \\geq 1} n^a e^{2n} x^{n^2}$ for $0 \\leq x < 1$.\nFind a real number $c$ such that\n\\begin{align*}\n& \\lim_{x \\to 1^-} F_a(x) e^{-1/(1-x)} = 0 \\qquad \\mbox{for all $a < c$, and} \\\\\n& \\lim_{x \\to 1^-} F_a(x) e^{-1/(1-x)} = \\infty \\qquad \\mbox{for all $a > c$.}\n\\end{align*}\n\n\\end{itemize}\n\n\\end{document}z", "solution": "The claim holds with $c=-\\frac{1}{2}$. Set $t := 1/(1-x)$, so that $x = 1 - 1/t$ and\n\\[\n- \\frac{1}{t} - \\frac{1}{t^2} \\leq \\log x \\leq - \\frac{1}{t}.\n\\]\nSet also $m := \\lfloor t \\rfloor$. In the following arguments, we use $c$ to refer to some positive constant independent of $n$ and $t$, but a different such constant at each appearance.\n\nSuppose first that $a > -\\frac{1}{2}$. Then\n\\begin{align*}\nF_a(x)e^{-t} &= \\sum_{n=1}^\\infty n^a e^{2n-t} x^{n^2}  \\\\\n&\\geq \\sum_{n=1}^\\infty n^a e^{2n-t-n^2/t-n^2/t^2}  \\\\\n&= \\sum_{n=1}^\\infty n^a e^{-n^2/t^2} e^{-t(1-n/t)^2}.\n\\end{align*}\nIf we restrict the sum to the range $t < n < t + \\sqrt{t}$, we may bound the summand from below by $c t^a$; we then have $F_a(x) e^{-t} > ct^{a+1/2}$ and this tends to $\\infty$ as $t \\to \\infty$.\n\nSuppose next that $a < -\\frac{1}{2}$. Then\n\\begin{align*}\nF_a(x)e^{-t} &= \\sum_{n=1}^\\infty n^a e^{2n-t} x^{n^2} \\\\\n&\\leq \\sum_{n=1}^\\infty n^a e^{-t(1-n/t)^2}.\n\\end{align*}\nFix $\\epsilon>0$ such that $a+\\epsilon < -\\frac{1}{2}$. For the summands with $t - t^{1/2+\\epsilon} < n < t + t^{1/2+\\epsilon}$, we may bound the summand from above by $ct^a$; this range of the sum is then dominated by $ct^{a+1/2+\\epsilon}$. For the summands with $n < t - t^{1/2+\\epsilon}$, we may bound the summand by $n^a e^{-t^{2\\epsilon}}$; this range of the sum is then dominated by $t e^{-t^{2\\epsilon}}$. For the summands with $n > t - t^{1/2+\\epsilon}$, we may again bound the summand by $n^a e^{-t^{2\\epsilon}}$; this range of the sum is then dominated by $c t^{a+1} e^{-t^{2\\epsilon}}$. Since all three bounds tends to 0 as $t \\to \\infty$, so then does $F_a(x) e^{-t}$.", "category": "Algebra", "source": "PUTNAM", "year": 2024, "content": "For a real number $a$, let $F_a(x) = \\sum_{n \\geq 1} n^a e^{2n} x^{n^2}$ for $0 \\leq x < 1$. Find a real number $c$ such that\n\\[\n\\lim_{x \\to 1^-} F_a(x) e^{-1/(1-x)} = 0 \\quad \\mbox{for all $a < c$, and}\n\\]\n\\[\n\\lim_{x \\to 1^-} F_a(x) e^{-1/(1-x)} = \\infty \\quad \\mbox{for all $a > c$.}\n\\]"}
