{"id": "usamo-2025-q1", "question": "Fix positive integers $k$ and $d$.\nProve that for all sufficiently large odd positive integers $n$,\nthe digits of the base-$2n$ representation of $n^k$ are all greater than $d$.", "solution": "<div class=\"mdframed\">\nFix positive integers $k$ and $d$.\nProve that for all sufficiently large odd positive integers $n$,\nthe digits of the base-$2n$ representation of $n^k$ are all greater than $d$.\n</div>\nThe problem actually doesn't have much to do with digits:\nthe idea is to pick any length $\\ell \\le k$,\nand look at the rightmost $\\ell$ digits of $n^k$;\nthat is, the remainder upon division by $(2n)^\\ell$.\nWe compute it exactly:\n\n<div class=\"claim*\">\n  Let $n \\ge 1$ be an odd integer, and $k \\ge \\ell \\ge 1$ integers.\n  Then\n  \\[ n^k \\bmod{(2n)^\\ell} = c(k,\\ell) \\cdot n^i \\]\n  for some odd integer $1 \\le c(k,\\ell) \\le 2^\\ell-1$.\n</div>\n<div class=\"proof\">\n  This follows directly by the Chinese remainder theorem,\n  with $c(k,\\ell)$ being the residue class of $n^{k-i} \\pmod{2^\\ell}$\n  (which makes sense because $n$ was odd).\n</div>\nIn particular, for the $\\ell$th digit from the right to be greater than $d$,\nit would be enough that\n\\[ c(k,\\ell) \\cdot n^\\ell \\ge (d+1) \\cdot (2n)^{\\ell-1}. \\]\nBut this inequality holds whenever $n \\ge (d+1) \\cdot 2^{\\ell-1}$.\n\nPutting this together by varying $\\ell$, we find that for all odd\n\\[ n \\ge (d+1) \\cdot 2^{k-1} \\]\nwe have that\n<ul>\n  \\ii $n^k$ has $k$ digits in base-$2n$; and\n  \\ii for each $\\ell = 1, \\dots, k$,\n  the $\\ell$th digit from the right is at least $d+1$\n</ul>\nso the problem is solved.\n\n<div class=\"remark*\">\n  Note it doesn't really matter that $c(k,i)$ is odd <em>per se</em>;\n  we only need that $c(k,i) \\ge 1$.\n</div>\n\\pagebreak", "category": null, "source": "USAMO", "year": 2025, "content": "Fix positive integers $k$ and $d$.\nProve that for all sufficiently large odd positive integers $n$,\nthe digits of the base-$2n$ representation of $n^k$ are all greater than $d$."}
{"id": "usamo-2025-q2", "question": "Let $n > k \\ge 1$ be integers.\nLet $P(x) \\in \\RR[x]$ be a polynomial of degree $n$\nwith no repeated roots and $P(0) \\neq 0$.\nSuppose that for any real numbers $a_0$, \\dots, $a_k$\nsuch that the polynomial $a_k x^k + \\dots + a_1 x + a_0$ divides $P(x)$,\nthe product $a_0 a_1 \\dots a_k$ is zero.\nProve that $P(x)$ has a nonreal root.", "solution": "```latex\n<div class=\"mdframed\">\nLet $n > k \\ge 1$ be integers.\nLet $P(x) \\in \\mathbb{R}[x]$ be a polynomial of degree $n$\nwith no repeated roots and $P(0) \\neq 0$.\nSuppose that for any real numbers $a_0$, \\dots, $a_k$\nsuch that the polynomial $a_k x^k + \\dots + a_1 x + a_0$ divides $P(x)$,\nthe product $a_0 a_1 \\dots a_k$ is zero.\nProve that $P(x)$ has a nonreal root.\n</div>\nBy considering any $k+1$ of the roots of $P$, we may as well assume WLOG that $n = k+1$.\nSuppose that $P(x) = (x+r_1) \\dots (x+r_n) \\in \\mathbb{R}[x]$ has $P(0) \\neq 0$.\nThen the problem hypothesis is that each of the $n$ polynomials\n(of degree $n-1$) given by\n\\begin{align*}\n  P_1(x) &= (x+r_2)(x+r_3)(x+r_4) \\dots (x+r_n) \\\\\n  P_2(x) &= (x+r_1)(x+r_3)(x+r_4) \\dots (x+r_n) \\\\\n  P_3(x) &= (x+r_1)(x+r_2)(x+r_4) \\dots (x+r_n) \\\\\n  &\\vdots= \\\\\n  P_n(x) &= (x+r_1)(x+r_2)(x+r_3) \\dots (x+r_{n-1})\n\\end{align*}\nhas at least one coefficient equal to zero.\n(Explicitly, $P_i(x) = \\frac{P(x)}{x+r_i}$.)\nWe'll prove that at least one $r_i$ is not real.\n\nObviously the leading and constant coefficients of each $P_i$ are nonzero,\nand there are $n-2$ other coefficients to choose between.\nSo by pigeonhole principle, we may assume, say,\nthat $P_1$ and $P_2$ share the position of a zero coefficient, say\nthe $x^k$ one, for some $1 \\le k < n-1$.\n\n<div class=\"claim*\">\n  If $P_1$ and $P_2$ both have $x^k$ coefficient equal to zero, then the polynomial\n  \\[ Q(x) = (x+r_3)(x+r_4) \\dots (x+r_n) \\]\n  has two consecutive zero coefficients, namely $b_k = b_{k-1} = 0$.\n</div>\n<div class=\"proof\">\n  Invoking Vieta formulas, suppose that\n  \\[ Q(x) = x^{n-2} + b_{n-3} x^{n-3} + \\dots + b_0. \\]\n  (And let $b_{n-2} = 1$.)\n  Then the fact that the $x^k$ coefficient of $P_1$ and $P_2$ are both zero means\n  \\[ r_1 b_k + b_{k-1} = r_2 b_k + b_{k-1} = 0 \\]\n  and hence that $b_k = b_{k-1} = 0$ (since the $r_i$ are nonzero).\n</div>\n\nTo solve the problem, we use:\n<div class=\"lemma*\">\n  If $F(x) \\in \\mathbb{R}[x]$ is a polynomial with two consecutive zero coefficients,\n  it cannot have all distinct real roots.\n</div>\nHere are two possible proofs of the lemma I know (there are more).\n\n<div class=\"proof\">\n  [First proof using Rolle's theorem]\n  Say $x^t$ and $x^{t+1}$ coefficients of $F$ are both zero.\n\n  Assume for contradiction all the roots of $F$ are real and distinct.\n  Then by Rolle's theorem, every higher-order derivative of $F$\n  should have this property too.\n  However, the $t$th order derivative of $F$ has a double root of $0$, contradiction.\n</div>\n\n<div class=\"proof\">\n  [Second proof using Descartes rule of signs]\n  The number of (nonzero) roots of $F$ is bounded above by\n  the number of sign changes of $F(x)$ (for the positive roots)\n  and the number of sign changes of $F(-x)$ (for the negative roots).\n  Now consider each pair of consecutive nonzero coefficients in $F$,\n  say ${\\star} x^i$ and ${\\star} x^j$ for $i > j$.\n<ul>\n    \\ii If $i-j=1$, then this sign change will only count for one of $F(x)$ or $F(-x)$\n    \\ii If $i-j \\ge 2$, then the sign change could count towards both $F(x)$ or $F(-x)$\n    (i.e.\\ counted twice), but also there is at least one zero coefficient between them.\n</ul>\n  Hence if $b$ is the number of nonzero coefficients of $F$,\n  and $z$ is the number of <em>consecutive runs</em> of zero coefficients of $F$,\n  then the number of real roots is bounded above by\n  \\[ 1 \\cdot (b-1-z) + 2 \\cdot z = b - 1 + z \\le \\deg F. \\]\n  However, if $F$ has <em>two</em> consecutive zero coefficients, then the inequality is strict.\n</div>\n\n<div class=\"remark*\">\n  The final claim has appeared before apparently\n  in the HUST Team Selection Test for the Vietnamese Math Society's\n  undergraduate olympiad; see \\url{https://aops.com/community/p33893374} for citation.\n</div>\n\\pagebreak\n```", "category": null, "source": "USAMO", "year": 2025, "content": "Let $n > k \\ge 1$ be integers.  \nLet $P(x) \\in \\mathbb{R}[x]$ be a polynomial of degree $n$  \nwith no repeated roots and $P(0) \\neq 0$.  \nSuppose that for any real numbers $a_0$, \\dots, $a_k$  \nsuch that the polynomial $a_k x^k + \\dots + a_1 x + a_0$ divides $P(x)$,  \nthe product $a_0 a_1 \\dots a_k$ is zero.  \nProve that $P(x)$ has a nonreal root.  "}
{"id": "usamo-2025-q3", "question": "Alice the architect and Bob the builder play a game.\nFirst, Alice chooses two points $P$ and $Q$ in the plane\nand a subset $\\mathcal{S}$ of the plane, which are announced to Bob.\nNext, Bob marks infinitely many points in the plane,\ndesignating each a city.\nHe may not place two cities within distance at most one unit of each other,\nand no three cities he places may be collinear.\nFinally, roads are constructed between the cities as follows:\neach pair $A$, $B$ of cities is connected with a road along the line segment $AB$\nif and only if the following condition holds:\n\\begin{quote}\nFor every city $C$ distinct from $A$ and $B$,\nthere exists $R\\in \\mathcal{S}$ such that $\\triangle PQR$ is directly similar\nto either $\\triangle ABC$ or $\\triangle BAC$.\n\\end{quote}\nAlice wins the game if (i) the resulting roads allow for travel\nbetween any pair of cities via a finite sequence of roads and (ii) no two roads cross.\nOtherwise, Bob wins. Determine, with proof, which player has a winning strategy.", "solution": "```tex\n<div class=\"mdframed\">\nAlice the architect and Bob the builder play a game.\nFirst, Alice chooses two points \\( P \\) and \\( Q \\) in the plane\nand a subset \\( \\mathcal{S} \\) of the plane, which are announced to Bob.\nNext, Bob marks infinitely many points in the plane,\ndesignating each a city.\nHe may not place two cities within distance at most one unit of each other,\nand no three cities he places may be collinear.\nFinally, roads are constructed between the cities as follows:\neach pair \\( A \\), \\( B \\) of cities is connected with a road along the line segment \\( AB \\)\nif and only if the following condition holds:\n<div class=\"quote\">\nFor every city \\( C \\) distinct from \\( A \\) and \\( B \\),\nthere exists \\( R \\in \\mathcal{S} \\) such that \\( \\triangle PQR \\) is directly similar\nto either \\( \\triangle ABC \\) or \\( \\triangle BAC \\).\n</div>\nAlice wins the game if (i) the resulting roads allow for travel\nbetween any pair of cities via a finite sequence of roads and (ii) no two roads cross.\nOtherwise, Bob wins. Determine, with proof, which player has a winning strategy.\n</div>\nThe answer is that Alice wins.\nLet's define a <em>Bob-set</em> \\( V \\) to be a set of points in the plane with no three collinear\nand with all distances at least \\( 1 \\).\nThe point of the problem is to prove the following fact.\n<div class=\"claim*\">\n  Given a Bob-set \\( V \\subseteq \\mathbb{R}^2 \\), consider the <em>Bob-graph</em>\n  with vertex set \\( V \\) defined as follows:\n  draw edge \\( ab \\) if and only if the disk with diameter \\( \\overline{ab} \\)\n  contains no other points of \\( V \\) on or inside it.\n  Then the Bob-graph is (i) connected, and (ii) planar.\n</div>\nProving this claim shows that Alice wins since Alice can specify \\( \\mathcal{S} \\)\nto be the set of points outside the disk of diameter \\( PQ \\).\n\n<div class=\"proof\">\n  [Proof that every Bob-graph is connected]\n  Assume for contradiction the graph is disconnected.\n  Let \\( p \\) and \\( q \\) be two points in different connected components.\n  Since \\( pq \\) is not an edge, there exists a third point \\( r \\)\n  inside the disk with diameter \\( \\overline{pq} \\).\n\n  Hence, \\( r \\) is in a different connected component\n  from at least one of \\( p \\) or \\( q \\) --- let's say point \\( p \\).\n  Then we repeat the same argument on the disk with diameter \\( \\overline{pr} \\)\n  to find a new point \\( s \\), non-adjacent to either \\( p \\) or \\( r \\).\n  See the figure below, where the X'ed out dashed edges indicate\n  points which are not only non-adjacent but in different connected components.\n\n<div class=\"center\">\n<div class=\"asy\">\n    size(6cm);\n    pair p = (-1,0);\n    pair q = (1,0);\n    pair r = (0.4,0.7);\n    filldraw(unitcircle, opacity(0.1)+blue, blue);\n    filldraw(circle((p+r)/2, abs(p-r)/2), opacity(0.1)+red, red);\n    pair s = (-0.3,0.6);\n    draw(p--q, dashed+blue);\n    draw(p--r, dashed+red);\n    draw(s--r, dashed);\n    dot(\"$p$\", p, dir(p));\n    dot(\"$q$\", q, dir(q));\n    dot(\"$r$\", r, dir(r));\n    dot(\"$s$\", s, dir(s));\n    picture X;\n    real eps = 0.05;\n    draw(X, (-eps,-eps)--(eps,eps), black+1.4);\n    draw(X, (eps,-eps)--(-eps,eps), black+1.4);\n    add(X);\n    add(shift(midpoint(p--r))*X);\n    add(shift(midpoint(s--r))*X);\n    label(\"$\\delta_1$\", (0,0), 2*dir(45), deepgreen);\n    label(\"$\\delta_2$\", midpoint(p--r), 2*dir(-10), deepgreen);\n    label(\"$\\delta_3$\", midpoint(s--r), 2*dir(100), deepgreen);\n</div>\n</div>\n\n  In this way we generate an infinite sequence of distances\n  \\( \\delta_1, \\delta_2, \\delta_3, \\dots \\) among the non-edges in the picture above.\n  By the ``Pythagorean theorem'' (or really the inequality for it), we have\n  \\[ \\delta_i^2 \\le \\delta_{i-1}^2 - 1 \\]\n  and this eventually generates a contradiction for large \\( i \\),\n  since we get \\( 0 \\le \\delta_i^2 \\le \\delta_1^2 - (i-1) \\).\n</div>\n\n<div class=\"proof\">\n  [Proof that every Bob-graph is planar]\n  Assume for contradiction edges \\( ac \\) and \\( bd \\) meet, meaning \\( abcd \\) is a convex quadrilateral.\n  WLOG assume \\( \\angle bad \\ge 90^{\\circ} \\) (each quadrilateral has an angle at least \\( 90^{\\circ} \\)).\n  Then the disk with diameter \\( \\overline{bd} \\) contains \\( a \\), contradiction.\n</div>\n\n<div class=\"remark*\">\n  In real life, the Bob-graph is actually called the <a href=\"https://w.wiki/DVnd\" target=\"_blank\">Gabriel graph</a>.\n  Note that we never require the Bob-set to be infinite;\n  the solution works unchanged for finite Bob-sets.\n\n  However, there are approaches that work for finite Bob-sets that don't work for\n  infinite sets, such as the <a href=\"https://www.graphclasses.org/classes/gc_1224.html\" target=\"_blank\">relative neighbor graph</a>,\n  in which one joins \\( a \\) and \\( b \\) iff there is no \\( c \\) such that\n  \\( d(a,b) \\le \\max \\{d(a,c), d(b,c)\\} \\).\n  In other words, edges are blocked by triangles where \\( ab \\) is the longest edge\n  (rather than by triangles where \\( ab \\) is the longest edge of a right or obtuse triangle\n  as in the Gabriel graph).\n\n  The relative neighbor graph has fewer edges than the Gabriel graph, so it is planar too.\n  When the Bob-set is finite, the relative distance graph is still connected.\n  The same argument above works where the distances now satisfy\n  \\[ \\delta_1 > \\delta_2 > \\dots \\]\n  instead, and since there are finitely many distances one arrives at a contradiction.\n\n  However for infinite Bob-sets the descending condition is insufficient,\n  and connectedness actually fails altogether.\n  A counterexample (communicated to me by Carl Schildkraut) is to start by taking\n  \\( A_n \\approx (2n,0) \\) and \\( B_n \\approx (2n+1, \\sqrt{3}) \\) for all \\( n \\ge 1 \\),\n  then perturb all the points slightly so that\n  \\begin{align*}\n    B_1A_1 &> A_1A_2 > A_2B_1 > B_1B_2 > B_2A_2 \\\\\n    &> A_2A_3 > A_3B_2 > B_2B_3 > B_3A_3 \\\\\n    &> \\dotsb.\n  \\end{align*}\n  A cartoon of the graph is shown below.\n<div class=\"center\">\n<div class=\"asy\">\n    dotfactor *= 1.5;\n    pair A1 = (0,0);\n    pair A2 = (2,0);\n    pair A3 = (4,0);\n    pair A4 = (6,0);\n    pair B1 = (1,3**0.5);\n    pair B2 = (3,3**0.5);\n    pair B3 = (5,3**0.5);\n    pair B4 = (7,3**0.5);\n    dot(\"$A_1$\", A1, dir(-90), blue);\n    dot(\"$A_2$\", A2, dir(-90), blue);\n    dot(\"$A_3$\", A3, dir(-90), blue);\n    dot(\"$B_1$\", B1, dir(90), blue);\n    dot(\"$B_2$\", B2, dir(90), blue);\n    dot(\"$B_3$\", B3, dir(90), blue);\n    label(\"$\\dots$\", A4, blue);\n    label(\"$\\dots$\", B4, blue);\n    draw(\"$2.08$\", A1--A2, dir(-90), blue, Margins);\n    draw(\"$2.04$\", A2--A3, dir(-90), blue, Margins);\n    draw(A3--A4, blue, Margins);\n    draw(\"$2.06$\", B1--B2, dir(90), blue, Margins);\n    draw(\"$2.02$\", B2--B3, dir(90), blue, Margins);\n    draw(B3--B4, blue, Margins);\n    draw(rotate(60)*\"$2.09$\", B1--A1, dotted);\n    draw(rotate(-60)*\"$2.07$\", B1--A2, dotted);\n    draw(rotate(60)*\"$2.05$\", B2--A2, dotted);\n    draw(rotate(-60)*\"$2.03$\", B2--A3, dotted);\n    draw(rotate(60)*\"$2.01$\", B3--A3, dotted);\n</div>\n</div>\n  In that case, \\( \\{A_n\\} \\) and \\( \\{B_n\\} \\) will be disconnected from each other:\n  none of the edges \\( A_nB_n \\) or \\( B_nA_{n+1} \\) are formed.\n  In this case the relative neighbor graph consists of the edges\n  \\( A_1A_2A_3A_4 \\dotsm \\) and \\( B_1 B_2 B_3 B_4 \\dotsm \\).\n  That's why for the present problem, the inequality\n  \\[ \\delta_i^2 \\le \\delta_{i-1}^2 - 1 \\]\n  plays such an important role, because it causes the (squared) distances\n  to decrease appreciably enough to give the final contradiction.\n</div>\n\\pagebreak\n\n\\section{Solutions to Day 2}\n```", "category": null, "source": "USAMO", "year": 2025, "content": "Alice the architect and Bob the builder play a game. First, Alice chooses two points $P$ and $Q$ in the plane and a subset $\\mathcal{S}$ of the plane, which are announced to Bob. Next, Bob marks infinitely many points in the plane, designating each a city. He may not place two cities within distance at most one unit of each other, and no three cities he places may be collinear. Finally, roads are constructed between the cities as follows: each pair $A$, $B$ of cities is connected with a road along the line segment $AB$ if and only if the following condition holds:\n<div class=\"quote\">\nFor every city $C$ distinct from $A$ and $B$, there exists $R\\in \\mathcal{S}$ such that $\\triangle PQR$ is directly similar to either $\\triangle ABC$ or $\\triangle BAC$.\n</div>\nAlice wins the game if (i) the resulting roads allow for travel between any pair of cities via a finite sequence of roads and (ii) no two roads cross. Otherwise, Bob wins. Determine, with proof, which player has a winning strategy."}
{"id": "usamo-2025-q4", "question": "Let $H$ be the orthocenter of an acute triangle $ABC$,\nlet $F$ be the foot of the altitude from $C$ to $AB$,\nand let $P$ be the reflection of $H$ across $BC$.\nSuppose that the circumcircle of triangle $AFP$ intersects line $BC$\nat two distinct points $X$ and $Y$.\nProve that $CX = CY$.", "solution": "<div class=\"mdframed\">\nLet $H$ be the orthocenter of an acute triangle $ABC$, let $F$ be the foot of the altitude from $C$ to $AB$, and let $P$ be the reflection of $H$ across $BC$. Suppose that the circumcircle of triangle $AFP$ intersects line $BC$ at two distinct points $X$ and $Y$. Prove that $CX = CY$.\n</div>\nLet $Q$ be the antipode of $B$.\n<div class=\"claim*\">\n  $AHQC$ is a parallelogram, and $APCQ$ is an isosceles trapezoid.\n</div>\n<div class=\"proof\">\n  As $\\overline{AH} \\perp \\overline{BC} \\perp \\overline{CQ}$ and $\\overline{CF} \\perp \\overline{AB} \\perp \\overline{AQ}$.\n</div>\n\n<div class=\"center\">\n<div class=\"asy\">\npair A = dir(110);\npair B = dir(210);\npair C = dir(330);\npair P = -B*C/A;\npair H = orthocenter(A, B, C);\npair F = foot(C, A, B);\npair Q = -B;\nfilldraw(A--B--C--cycle, opacity(0.1)+lightblue, blue);\ndraw(unitcircle, lightblue);\nfilldraw(A--H--C--Q--cycle, opacity(0.1)+lightred, red);\ndraw(H--P, blue);\npair O = origin;\ndraw(B--Q, dotted+blue);\ndraw(F--H, blue);\npair M = midpoint(Q--C);\npair N = midpoint(A--F);\ndraw(M--N, red);\ndraw(A--M--P, deepgreen+dashed);\ndraw(M--F, deepgreen+dashed);\n\ndot(\"$A$\", A, dir(A));\ndot(\"$B$\", B, dir(B));\ndot(\"$C$\", C, dir(C));\ndot(\"$P$\", P, dir(P));\ndot(\"$H$\", H, dir(220));\ndot(\"$F$\", F, dir(F));\ndot(\"$Q$\", Q, dir(Q));\ndot(\"$O$\", O, dir(270));\ndot(\"$M$\", M, dir(M));\ndot(\"$N$\", N, dir(N));\n</div>\n</div>\n\nLet $M$ be the midpoint of $\\overline{QC}$.\n<div class=\"claim*\">\n  Point $M$ is the circumcenter of $\\triangle AFP$.\n</div>\n<div class=\"proof\">\n  It's clear that $MA = MP$ from the isosceles trapezoid. As for $MA = MF$, let $N$ denote the midpoint of $\\overline{AF}$; then $\\overline{MN}$ is a midline of the parallelogram, so $\\overline{MN} \\perp \\overline{AF}$.\n</div>\n\nSince $\\overline{CM} \\perp \\overline{BC}$ and $M$ is the center of $(AFP)$, it follows $CX = CY$.", "category": null, "source": "USAMO", "year": 2025, "content": "Let $H$ be the orthocenter of an acute triangle $ABC$,\nlet $F$ be the foot of the altitude from $C$ to $AB$,\nand let $P$ be the reflection of $H$ across $BC$.\nSuppose that the circumcircle of triangle $AFP$ intersects line $BC$\nat two distinct points $X$ and $Y$.\nProve that $CX = CY$."}
{"id": "usamo-2025-q5", "question": "Find all positive integers $k$ such that:\nfor every positive integer $n$,\nthe sum \\[ \\binom n0^k + \\binom n1^k + \\dots + \\binom nn^k \\] is divisible by $n+1$.", "solution": "<div class=\"mdframed\">\nFind all positive integers $k$ such that:\nfor every positive integer $n$,\nthe sum \\[ \\binom n0^k + \\binom n1^k + \\dots + \\binom nn^k \\] is divisible by $n+1$.\n</div>\nThe answer is all even $k$.\n\nLet's abbreviate $S(n) := \\binom n0^k + \\dots + \\binom nn^k$ for the sum in the problem.\n\n\\paragraph{Proof that even $k$ is necessary.}\nChoose $n=2$. We need $3 \\mid S(2) = 2+2^k$,\nwhich requires $k$ to be even.\n\n<div class=\"remark\">\n  It's actually not much more difficult to just use $n = p-1$ for prime $p$,\n  since $\\binom{p-1}{i} \\equiv (-1)^i \\pmod p$.\n  Hence $S(p-1) \\equiv 1 + (-1)^k + 1 + (-1)^k + \\dots + 1 \\pmod p$,\n  and this also requires $k$ to be even.\n  This special case is instructive in figuring out the proof to follow.\n</div>\n\n\\paragraph{Proof that $k$ is sufficient.}\nFrom now on we treat $k$ as fixed, and we let $p^e$ be a prime fully dividing $n+1$.\nThe basic idea is to reduce from $n+1$ to $(n+1)/p$ by an induction.\n\n<div class=\"remark\">\n  Here is a concrete illustration that makes it clear what's going on.\n  Let $p = 5$.\n  When $n = p-1 = 4$, we have\n  \\[ S(4) = 1^k + 4^k + 6^k + 4^k + 1^k \\equiv 1 + 1 + 1 + 1 + 1 \\equiv 0 \\pmod 5. \\]\n  When $n = p^2-1 = 24$, the $25$ terms of $S(24)$ in order are, modulo $25$,\n  \\begin{align*}\n    S(24) &\\equiv 1^k + 1^k + 1^k + 1^k + 1^k\\\\\n    &+ 4^k + 4^k + 4^k + 4^k + 4^k \\\\\n    &+ 6^k + 6^k + 6^k + 6^k + 6^k \\\\\n    &+ 4^k + 4^k + 4^k + 4^k + 4^k \\\\\n    &+ 1^k + 1^k + 1^k + 1^k + 1^k \\\\\n    &= 5(1^k + 4^k + 6^k + 4^k + 1^k).\n  \\end{align*}\n  The point is that $S(24)$ has five copies of $S(4)$, modulo $25$.\n</div>\n\nTo make the pattern in the remark explicit, we prove the following lemma\non each <em>individual</em> binomial coefficient.\n<div class=\"lemma\">\n  Suppose $p^e$ is a prime power which fully divides $n+1$. Then\n  \\[ \\binom{n}{i} \\equiv \\pm \\binom{\\frac{n+1}{p}-1}{\\left\\lfloor i/p \\right\\rfloor} \\pmod{p^e}. \\]\n</div>\n\n<div class=\"proof\">\n  [Proof of lemma]\n  It's easiest to understand the proof by\n  looking at the cases $\\left\\lfloor i/p \\right\\rfloor \\in \\{0,1,2\\}$ first.\n<ul>\n  \\item For $0 \\le i < p$, since $n \\equiv -1 \\mod p^e$, we have\n  \\[ \\binom{n}{i} = \\frac{n(n-1) \\dots (n-i+1)}{1 \\cdot 2 \\cdot \\dots \\cdot i}\n    \\equiv \\frac{(-1)(-2) \\dots (-i)}{1 \\cdot 2 \\cdot \\dots \\cdot i} \\equiv \\pm 1 \\pmod{p^e}. \\]\n  \\item For $p \\le i < 2p$ we have\n  \\begin{align*}\n    \\binom{n}{i}\n    &\\equiv \\pm 1 \\cdot \\frac{n-p+1}{p} \\cdot \\frac{(n-p)(n-p-1) \\dots (n-i+1)}{(p+1)(p+2) \\dots i} \\\\\n    &\\equiv \\pm 1 \\cdot \\frac{\\frac{n-p+1}{p}}{1} \\cdot \\pm 1 \\\\\n    &\\equiv \\pm \\binom{\\frac{n+1}{p}-1}{1} \\pmod{p^e}.\n  \\end{align*}\n  \\item For $2p \\le i < 3p$ the analogous reasoning gives\n  \\begin{align*}\n    \\binom ni\n    &\\equiv \\pm 1 \\cdot \\frac{n-p+1}{p} \\cdot \\pm 1 \\cdot \\frac{n-2p+1}{2p} \\cdot \\pm 1 \\\\\n    &\\equiv \\pm \\frac{\\left(\\frac{n+1}{p}-1\\right)\\left( \\frac{n+1}{p}-2 \\right) }{1 \\cdot 2} \\\\\n    &\\equiv \\pm \\binom{\\frac{n+1}{p}-1}{2} \\pmod{p^e}.\n  \\end{align*}\n</ul>\n  And so on. The point is that in general, if we write\n  \\[ \\binom ni = \\prod_{1 \\le j \\le i} \\frac{n-(j-1)}{j} \\]\n  then the fractions for $p \\nmid j$ are all $\\pm 1 \\pmod{p^e}$.\n  So only considers those $j$ with $p \\mid j$; in that case\n  one obtains the claimed $\\binom{\\frac{n+1}{p}-1}{\\left\\lfloor i/p \\right\\rfloor}$ exactly\n  (even without having to take modulo $p^e$).\n</div>\n\nFrom the lemma, it follows if $p^e$ is a prime power which fully divides $n+1$, then\n\\[ S(n) \\equiv p \\cdot S\\left( \\frac{n+1}{p}-1 \\right) \\pmod{p^e} \\]\nby grouping the $n+1$ terms (for $0 \\le i \\le n$)\ninto consecutive ranges of length $p$ (by the value of $\\left\\lfloor i/p \\right\\rfloor$).\n\n<div class=\"remark\">\n  Actually, with the exact same proof (with better $\\pm$ bookkeeping) one may show that\n  \\[ n+1 \\mid \\sum_{i=0}^n \\left( (-1)^i \\binom ni \\right)^k \\]\n  holds for <em>all</em> nonnegative integers $k$, not just $k$ even.\n  So in some sense this result is more natural than the one in the problem statement.\n</div>\n\\pagebreak", "category": null, "source": "USAMO", "year": 2025, "content": "Find all positive integers \\( k \\) such that:\nfor every positive integer \\( n \\),\nthe sum \n\\[\n\\binom{n}{0}^k + \\binom{n}{1}^k + \\dots + \\binom{n}{n}^k \n\\]\nis divisible by \\( n+1 \\)."}
{"id": "usamo-2025-q6", "question": "Let $m$ and $n$ be positive integers with $m\\geq n$.\nThere are $m$ cupcakes of different flavors arranged around a circle\nand $n$ people who like cupcakes.\nEach person assigns a nonnegative real number score to each cupcake,\ndepending on how much they like the cupcake.\nSuppose that for each person $P$, it is possible to partition the circle\nof $m$ cupcakes into $n$ groups of consecutive cupcakes\nso that the sum of $P$'s scores of the cupcakes in each group is at least $1$.\nProve that it is possible to distribute the $m$ cupcakes to the $n$ people\nso that each person $P$ receives cupcakes of total score at least $1$ with respect to $P$.", "solution": "<div class=\"mdframed\">\nLet $m$ and $n$ be positive integers with $m \\geq n$.\nThere are $m$ cupcakes of different flavors arranged around a circle\nand $n$ people who like cupcakes.\nEach person assigns a nonnegative real number score to each cupcake,\ndepending on how much they like the cupcake.\nSuppose that for each person $P$, it is possible to partition the circle\nof $m$ cupcakes into $n$ groups of consecutive cupcakes\nso that the sum of $P$'s scores of the cupcakes in each group is at least $1$.\nProve that it is possible to distribute the $m$ cupcakes to the $n$ people\nso that each person $P$ receives cupcakes of total score at least $1$ with respect to $P$.\n</div>\nArbitrarily pick any one person --- call her Pip --- and her $n$ arcs.\nThe initial idea is to try to apply Hall's marriage lemma to match\nthe $n$ people with Pip's arcs (such that each such person is happy with their matched arc).\nTo that end, construct the obvious bipartite graph $\\mathfrak{G}$\nbetween the people and the arcs for Pip.\n\nWe now consider the following algorithm, which takes several steps.\n<ul>\n  <li>If a perfect matching of $\\mathfrak{G}$ exists, we're done!</li>\n  <li>We're probably not that lucky.\n  Per Hall's condition, this means there is a <em>bad set</em> $\\mathcal{B}_1$ of people,\n  who are compatible with fewer than $|\\mathcal{B}_1|$ of the arcs.\n  Then delete $\\mathcal{B}_1$ and the neighbors of $\\mathcal{B}_1$,\n  then try to find a matching on the remaining graph.</li>\n  <li>If a matching exists now, terminate the algorithm.\n  Otherwise, that means there's another bad set $\\mathcal{B}_2$\n  for the remaining graph.\n  We again delete $\\mathcal{B}_2$ and the fewer than $\\mathcal{B}_2$ neighbors.</li>\n  <li>Repeat until some perfect matching $\\mathcal{M}$ is possible in the remaining graph,\n  i.e.\\ there are no more bad sets (and then terminate once that occurs).</li>\n  Since Pip is a universal vertex, it's impossible to delete Pip,\n  so the algorithm does indeed terminate with nonempty $\\mathcal{M}$.\n</ul>\n\nA cartoon of this picture is shown below.\n<div class=\"center\">\n<div class=\"asy\">\n  size(8cm);\n  dotfactor *= 1.3;\n  real w = 3;\n  real eps = 0.4;\n  label(\"People\", (-w,10));\n  label(\"Arcs of Pip\", (w,10));\n  filldraw(box((-w-eps, 9+eps), (-w+eps,7-eps)), opacity(0.1) + lightred, red + 1.2);\n  filldraw(box((-w-eps, 6+eps), (-w+eps,5-eps)), opacity(0.1) + lightred, orange + 1.2);\n  filldraw(box((-w-eps, 4+eps), (-w+eps,2-eps)), opacity(0.1) + lightred, brown + 1.2);\n\n  filldraw(box((w-eps, 9+eps), (w+eps,8-eps)), opacity(0.1) + lightred, red + 1.2);\n  filldraw(box((w-eps, 7+eps), (w+eps,7-eps)), opacity(0.1) + lightred, orange + 1.2);\n  filldraw(box((w-eps, 6+eps), (w+eps,5-eps)), opacity(0.1) + lightred, brown + 1.2);\n\n  draw((-w + eps, 9 + eps)--(w - eps, 9 + eps), red + dashed);\n  draw((-w + eps, 7 - eps)--(w - eps, 8 - eps), red + dashed);\n  draw((-w + eps, 6 + eps)--(w - eps, 9 + eps), orange + dashed);\n  draw((-w + eps, 5 - eps)--(w - eps, 7 - eps), orange + dashed);\n  draw((-w + eps, 4 + eps)--(w - eps, 9 + eps), brown + dashed);\n  draw((-w + eps, 2 - eps)--(w - eps, 5 - eps), brown + dashed);\n\n  label((-w - eps, 8), \"Bad set $\\mathcal{B}_1$\", dir(180), black);\n  label((-w - eps, 5.5), \"Bad set $\\mathcal{B}_2$\", dir(180), black);\n  label((-w - eps, 3), \"Bad set $\\mathcal{B}_3$\", dir(180), black);\n\n  draw((-w,1)--(w,1), deepgreen + 1.3);\n  draw((-w,0)--(w,0), deepgreen + 1.3);\n  label((0, 0.5), \"Final perfect matching $\\mathcal{M}$\", deepgreen);\n\n  for (int i=0; i<10; ++i) {\n    dot((w,i), blue);\n    dot((-w,i), blue);\n  }\n  label(\"Pip\", (-w,0), dir(180), blue);\n</div>\n</div>\nWe commit to assigning each of person in $\\mathcal{M}$ their matched arc\n(in particular if there are no bad sets at all, the problem is already solved).\nNow we finish the problem by induction on $n$\n(for the remaining people) by simply deleting the arcs used up by $\\mathcal{M}$.\n\nTo see why this deletion-induction works,\nconsider any particular person Quinn not in $\\mathcal{M}$.\nBy definition, Quinn is not happy with any of the arcs in $\\mathcal{M}$.\nSo when an arc $\\mathcal{A}$ of $\\mathcal{M}$ is deleted,\nit had value less than $1$ for Quinn\nso in particular it couldn't contain entirely any of Quinn's arcs.\nHence at most one endpoint among Quinn's arcs was in the deleted arc $\\mathcal{A}$.\nWhen this happens, this causes two arcs of Quinn to merge, and the merged value is\n\\[\n(\\ge 1) + (\\ge 1) - (\\le 1) \\qquad \\ge \\qquad 1\n\\]\nmeaning the induction is OK.\nSee below for a cartoon of the deletion,\nwhere Pip's arcs are drawn in blue while Quinn's arcs and scores are drawn in red\n(in this example $n=3$).\n<div class=\"center\">\n<div class=\"asy\">\n  size(13cm);\n  usepackage(\"amsmath\");\n  pair O = (0,0);\n  picture before;\n  picture after;\n\n  real r = 1;\n  real s = 0.9;\n  real t = 0.65;\n\n  draw(before, arc(O, s, -20, 80), red + 1.3);\n  draw(before, arc(O, s, 100, 200), red + 1.3);\n  draw(before, arc(O, s, 220, 320), red + 1.3);\n\n  draw(before, \"Pip arc to delete\", arc(O, r,  40, 140), blue + 1.3);\n  draw(before, rotate(-60)*\"Pip arc\", arc(O, r, 160, 260), blue + 1.3);\n  draw(before, rotate( 60)*\"Pip arc\", arc(O, r, 280, 380), blue + 1.3);\n\n  label(before, \"$\\boxed{0.2}$\", t*dir(120), red);\n  label(before, \"$\\boxed{0.3}$\", t*dir( 60), red);\n  label(before, \"$\\boxed{0.8}$\", t*dir(180), red);\n  label(before, \"$\\boxed{0.43}$\", t*dir(240), red);\n  label(before, \"$\\boxed{0.57}$\", t*dir(300), red);\n  label(before, \"$\\boxed{0.7}$\", t*dir(  0), red);\n  label(before, minipage(\"\\centering Quinn's \\\\ values\", 3cm), O, red);\n\n  draw(after, arc(O, s, -20, 200), red + 1.3);\n  draw(after, arc(O, s, 220, 320), red + 1.3);\n\n  draw(after, rotate(-60)*\"Pip arc\", arc(O, r, 160, 260), blue + 1.3);\n  draw(after, rotate( 60)*\"Pip arc\", arc(O, r, 280, 380), blue + 1.3);\n\n  label(after, \"$\\boxed{0.8}$\", t*dir(180), red);\n  label(after, \"$\\boxed{0.43}$\", t*dir(240), red);\n  label(after, \"$\\boxed{0.57}$\", t*dir(300), red);\n  label(after, \"$\\boxed{0.7}$\", t*dir(  0), red);\n  label(after, minipage(\"\\centering Quinn's \\\\ values\", 3cm), O, red);\n\n  add(before);\n  add(shift(3.2,0)*after);\n</div>\n</div>\n\n<div class=\"remark*?\">\n  This deletion argument can be thought of in some special cases even\n  before the realization of Hall, in the case where $\\mathcal{M}$ has only one person (Pip).\n  This amounts to saying that if one of Pip's arcs isn't liked by anybody,\n  then that arc can be deleted and the induction carries through.\n</div>\n<div class=\"remark*?\">\n  Conversely, it should be reasonable to expect Hall's theorem to be helpful\n  even before finding the deletion argument.\n  While working on this problem, one of the first things I said was:\n  <div class=\"quote\">\n    ``We should let Hall do the heavy lifting for us:\n    find a way to make $n$ groups that satisfy Hall's condition,\n    rather than an assignment of $n$ groups to $n$ people.''\n  </div>\n  As a general heuristic, for any type of ``compatible matching'' problem,\n  Hall's condition is usually the go-to tool.\n  (It is much easier to verify Hall's condition than actually find the matching yourself.)\n  Actually in most competition problems, if one realizes one is in a Hall setting,\n  one is usually close to finishing the problem.\n  This is a relatively rare example in which one needs an additional idea\n  to go alongside Hall's theorem.\n</div>\n\\pagebreak\n", "category": null, "source": "USAMO", "year": 2025, "content": "Let $m$ and $n$ be positive integers with $m \\geq n$.  \nThere are $m$ cupcakes of different flavors arranged around a circle  \nand $n$ people who like cupcakes.  \nEach person assigns a nonnegative real number score to each cupcake,  \ndepending on how much they like the cupcake.  \nSuppose that for each person $P$, it is possible to partition the circle  \nof $m$ cupcakes into $n$ groups of consecutive cupcakes  \nso that the sum of $P$'s scores of the cupcakes in each group is at least $1$.  \nProve that it is possible to distribute the $m$ cupcakes to the $n$ people  \nso that each person $P$ receives cupcakes of total score at least $1$ with respect to $P$."}
